;/*FB_PKG_DELIM*/

__d("EBBridgedAPI",["IEBAPI"],(function(a,b,c,d,e,f,g){"use strict";b={getContactEpochHead:(a=d("IEBAPI")).makeBridgedApi("getContactEpochHead"),getMessageKeys:a.makeBridgedApi("getMessageKeys"),isEbEnabledEbSwitch:a.makeBridgedApi("isEbEnabledEbSwitch"),messageRangeQueryForIndexing:a.makeBridgedApi("messageRangeQueryForIndexing")};c=b;g["default"]=c}),98);
__d("LSIssueAttachmentsRangeQuery",["LSGetCursor","LSIssueNewTask"],(function(a,b,c,d,e,f){function a(){var a=arguments,c=a[a.length-1],d=[],e=[];return c.sequence([function(e){return c.sequence([function(b){return c.db.table(9).fetch([[[a[0]]]]).next().then(function(a,b){var e=a.done;a=a.value;return e?d[0]=c.i64.cast([0,1]):(b=a.item,d[5]=b.syncGroup,c.i64.neq(d[5],void 0)?d[4]=d[5]:d[4]=c.i64.cast([0,1]),d[0]=d[4])})},function(a){return c.storedProcedure(b("LSGetCursor"),d[0]).then(function(a){return a=a,d[2]=a[0],a})},function(e){return c.db.table(17).fetch([[[a[0],a[1]]]]).next().then(function(e,f){var g=e.done;e=e.value;return g?c.sequence([function(b){return c.db.table(9).fetch([[[a[0]]]]).next().then(function(b,e){var a=b.done;b=b.value;return a?d[4]=c.i64.cast([0,1]):(e=b.item,d[9]=e.syncGroup,c.i64.neq(d[9],void 0)?d[8]=d[9]:d[8]=c.i64.cast([0,1]),d[4]=d[8])})},function(e){return d[6]=new c.Map(),d[6].set("thread_key",a[0]),d[6].set("media_group",a[1]),d[6].set("max_timestamp_ms",c.i64.cast([2328,1316134911])),d[6].set("cursor",d[2]),d[6].set("sync_group",d[4]),d[6].set("last_loaded_message_id",void 0),d[7]=c.toJSON(d[6]),c.storedProcedure(b("LSIssueNewTask"),"arq",c.i64.cast([0,105]),d[7],void 0,void 0,c.i64.cast([0,0]),c.i64.cast([0,0]),void 0,void 0,c.i64.cast([0,0]),c.i64.cast([0,0]))}]):(f=e.item,f.hasMoreBefore?c.sequence([function(b){return c.db.table(9).fetch([[[a[0]]]]).next().then(function(b,e){var a=b.done;b=b.value;return a?d[4]=c.i64.cast([0,1]):(e=b.item,d[9]=e.syncGroup,c.i64.neq(d[9],void 0)?d[8]=d[9]:d[8]=c.i64.cast([0,1]),d[4]=d[8])})},function(e){return d[6]=new c.Map(),d[6].set("thread_key",a[0]),d[6].set("media_group",a[1]),d[6].set("max_timestamp_ms",f.minTimestampMs),d[6].set("cursor",d[2]),d[6].set("sync_group",d[4]),d[6].set("last_loaded_message_id",void 0),d[7]=c.toJSON(d[6]),c.storedProcedure(b("LSIssueNewTask"),"arq",c.i64.cast([0,105]),d[7],void 0,void 0,c.i64.cast([0,0]),c.i64.cast([0,0]),void 0,void 0,c.i64.cast([0,0]),c.i64.cast([0,0]))}]):c.resolve())})}])},function(a){return c.resolve(e)}])}a.__sproc_name__="LSMailboxIssueAttachmentsRangeQueryStoredProcedure";a.__tables__=["threads","attachments_ranges_v2__generated"];e.exports=a}),null);
__d("LSIssueAttachmentsRangeQueryStoredProcedure",["LSIssueAttachmentsRangeQuery","LSSynchronousPromise","Promise","cr:8709"],(function(a,b,c,d,e,f,g){var h;function a(a,e){a=a.storedProcedure(c("LSIssueAttachmentsRangeQuery"),e.threadKey,e.mediaGroup);return(h||(h=b("Promise"))).resolve(d("LSSynchronousPromise").maybeExtractValueIfSynchronousPromise(a))}g["default"]=a}),98);
__d("MAWFetchAndPersistMedia",["CurrentUser","EBAPI","EchoMessage","EchoMessageMediaFieldUtils","I64","LSDatabaseSingleton","LSIntEnum","LSMEBTaskCreationSource","MAWHandleEchoProtobufsRestoreApi","MAWJids","MAWJobDefinitions","MAWMediaRestoreEBRange","MAWMpsGating","MAWMsgType","MAWRestoreMessagesFromEncryptedBackupsDeferred","MAWRestoreProtobufsFromEncryptedBackupsDeferred","MSGDataclassTypes.flow","MpsOverBridge","MpsTypes","ReQL","WAJids","WALogger","WAResultOrError","justknobx"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j,k,l,m=c("justknobx")._("3177"),n=c("justknobx")._("2538"),o=c("justknobx")._("3916"),p="timeout",q=new Set([d("EchoMessageMediaFieldUtils").AttachmentType.IMAGE,d("EchoMessageMediaFieldUtils").AttachmentType.VIDEO,d("EchoMessageMediaFieldUtils").AttachmentType.GIF]),r=new Set([d("MAWMsgType").MSG_TYPE.IMAGE,d("MAWMsgType").MSG_TYPE.VIDEO,d("MAWMsgType").MSG_TYPE.GIF]);function a(a,b,c,e){var f=d("MAWMediaRestoreEBRange").getMediaRestoreEBRange(),g=f.getRange(b),h=d("WAJids").threadIdForChatJid(a);e==null||e.addAnnotations({bool:{rangeHasMoreBefore:g.hasMoreBefore,rangeIsDefault:g.isDefault===!0}});if(g.hasMoreBefore===!1)return Promise.resolve();e==null||e.addPoint("eb_fetch_and_persist_start",{int:{mediaGalleryGroup:c}});return w({jid:a,nextTimestampMsBefore:g.nextTimestampMsBefore,numMessages:(a=g.pageSize)!=null?a:m,threadId:h}).then(function(a){var g=a.error;if(g!=null)e==null||e.addPoint("eb_fetch_and_persist_error",{string:{error:g}});else{var i;e==null||e.addAnnotations({bool:{responseHasMoreAfter:a.hasMoreAfter===!0,responseHasMoreBefore:a.hasMoreBefore===!0,responseNextMessageTimestampMsBeforeSet:a.nextMessageTimestampMsBefore!=null},int:{responseEchoMessages:(i=(i=a.echoMessages)==null?void 0:i.length)!=null?i:0,responseProtoMessages:(i=(i=a.protobufMessages)==null?void 0:i.length)!=null?i:0}})}if(g!==p){f.updateRange(b,{hasMoreBefore:(i=a==null?void 0:a.hasMoreBefore)!=null?i:!1,nextTimestampMsBefore:(j||(j=d("I64"))).to_string((g=a==null?void 0:a.nextMessageTimestampMsBefore)!=null?g:(j||(j=d("I64"))).zero)})}return s(a,h,b).then(function(){e==null||e.addPoint("eb_fetch_and_persist_end");return v(b,c,{hasMoreBefore:!0})})})}function s(a,b,c){if(a.success===!1)return Promise.resolve();if(a.echoMessages!=null&&a.echoMessages.length>0)return t(a,b,c);return a.protobufMessages!=null&&a.protobufMessages.length>0?u(a,b,c):Promise.resolve()}function t(a,b,e){var f;f=(f=a==null?void 0:a.echoMessages)!=null?f:[];var g=f.filter(function(a){var b;a=d("EchoMessage").decodeEchoMessage(a);return(a==null?void 0:a.contentType)===d("EchoMessage").EchoMessageContentType.MEDIA&&q.has(a==null||(b=a.mediaData)==null?void 0:b.attachmentType)});if(f.length!==g.length){f=d("MAWMediaRestoreEBRange").getMediaRestoreEBRange();f.updatePageSize(e,n)}return d("MAWRestoreMessagesFromEncryptedBackupsDeferred").call("AdvancedCrypto",d("MAWJobDefinitions").toThreadJidPrimaryId(b),g,(f=a==null?void 0:a.hasMoreBefore)!=null?f:!1,void 0,(e=a==null?void 0:a.hasMoreAfter)!=null?e:!1,void 0,(b=a==null?void 0:a.isPointQuery)!=null?b:!1,a==null?void 0:a.requestId,a==null?void 0:a.referenceTimestamp,c("LSMEBTaskCreationSource").MEDIA_GALLERY_RESTORE).catch(function(a){d("WALogger").ERROR(h||(h=babelHelpers.taggedTemplateLiteralLoose(["MediaPersist Echo error: ",""])),a)})}function u(a,b,e){var f,g=d("MAWJids").toUserJid(c("CurrentUser").getAccountID());f=(f=a==null?void 0:a.protobufMessages)!=null?f:[];var h=f.filter(function(a){a=d("MAWHandleEchoProtobufsRestoreApi").decodeDecryptedMessageProtobuf(a,g,void 0,new Set(),new Set(),new Map(),new Map(),new Map(),!0);return r.has(a.msgType)});if(f.length!==h.length){f=d("MAWMediaRestoreEBRange").getMediaRestoreEBRange();f.updatePageSize(e,n)}return d("MAWRestoreProtobufsFromEncryptedBackupsDeferred").call("AdvancedCrypto",d("MAWJobDefinitions").toThreadJidPrimaryId(b),h,(f=a==null?void 0:a.hasMoreBefore)!=null?f:!1,void 0,(e=a==null?void 0:a.hasMoreAfter)!=null?e:!1,void 0,(b=a==null?void 0:a.isPointQuery)!=null?b:!1,a==null?void 0:a.requestId,a==null?void 0:a.referenceTimestamp,void 0,void 0,(j||(j=d("I64"))).of_int32(c("LSMEBTaskCreationSource").MEDIA_GALLERY_RESTORE)).catch(function(a){d("WALogger").ERROR(i||(i=babelHelpers.taggedTemplateLiteralLoose(["MediaPersist Protobuf error: ",""])),a)})}async function v(a,b,c){var e=await (k||(k=d("LSDatabaseSingleton"))).LSDatabaseSingleton;return e.runInTransaction(async function(f){var g=await d("ReQL").firstAsync(d("ReQL").fromTableAscending(e.tables.attachments_ranges_v2__generated).getKeyRange(a).filter(function(a){return(j||(j=d("I64"))).equal(a.mediaGroup,(l||(l=d("LSIntEnum"))).ofNumber(b))}));if(g==null)return;var h=babelHelpers.extends({},g,c);return f.attachments_ranges_v2__generated.upsert([g.threadKey,g.mediaGroup,g.minTimestampMs],h)},"readwrite","ui",void 0,f.id+":266")}async function w(a){var b,e=a.jid,f=a.nextTimestampMsBefore,g=a.numMessages;a=a.threadId;var h;d("MAWMpsGating").isSearchOnMpsEnabled()||d("MAWMpsGating").isFullMpsEnabled()?h=d("MpsOverBridge").mps().loadMessages({config:{persistToReverb:"no-persist",shouldFetchSupplementals:!1,shouldFetchTags:!0,shouldIgnoreLocalOnly:!0,strategy:"remote-only",tagsFilter:new Set([d("MSGDataclassTypes.flow").MpsMessageTag.Photo,d("MSGDataclassTypes.flow").MpsMessageTag.Video])},debug:{purpose:"MAWFetchAndPersistMedia"},direction:"desc",from:[d("MpsTypes").toTimestamp(Number(f)),null],numMessages:g,threadId:d("MpsTypes").toThreadId(e)}).then(function(a){var b,e;if(a.success===!1)return a;var g=a.value.messages.map(d("MAWJobDefinitions").mpsMessageToEncryptedBackupsMessage);b=(b=a.value.cursorInfo.endCursor)==null?void 0:b[0];e=(e=a.value.cursorInfo.startCursor)==null?void 0:e[0];return d("WAResultOrError").makeResult({echoMessages:[],hasMoreAfter:a.value.cursorInfo.hasPrevious,hasMoreBefore:a.value.cursorInfo.hasNext,isPointQuery:!1,mpsMessageQuery:void 0,nextMessageTimestampMsAfter:e==null?void 0:(j||(j=d("I64"))).of_float(e),nextMessageTimestampMsBefore:b==null?void 0:(j||(j=d("I64"))).of_float(b),protobufMessages:g,referenceTimestamp:f,requestId:void 0,taskSource:c("LSMEBTaskCreationSource").MEDIA_GALLERY_RESTORE})}):h=c("EBAPI").messageRangeQueryForIndexing({chatJid:e,direction:"before",numMessages:g,sortOrderMs:f,source:c("LSMEBTaskCreationSource").MEDIA_GALLERY_RESTORE});var i=null;h=await Promise.race([h,new Promise(function(a){i=window.setTimeout(function(){return a(d("WAResultOrError").makeError(p))},o)})]);window.clearTimeout(i);if(h.success===!1)return h;h=h.value;b=(j||(j=d("I64"))).to_string((b=h==null?void 0:h.nextMessageTimestampMsBefore)!=null?b:(j||(j=d("I64"))).zero);return(h==null?void 0:h.referenceTimestamp)===b?g===n?d("WAResultOrError").makeError("Retried with max pageSize: "+n+". Still stuck"):w({jid:e,nextTimestampMsBefore:b,numMessages:n,threadId:a}):h}g.MAWFetchAndPersistMedia=a;g.updateLocalAttachmentsRange=v}),98);
__d("useMAWBulkMaybeAutoTriggerDownload",["MAWDownloadMediaInWorkerDeferred","MAWMediaDownloadStatus","MAWMediaManagerUiIntegrationCheck","react","react-compiler-runtime","useAsyncReStore","useMAWMediaDownloadStatusBulk"],(function(a,b,c,d,e,f,g){"use strict";var h;b=h||d("react");var i=b.useEffect;b.useMemo;var j=b.useRef;function a(a,b,e,f){var g=d("react-compiler-runtime").c(13);f=c("useMAWMediaDownloadStatusBulk")(a,f);f=f.mawMediaStatuses;var h;g[0]===Symbol["for"]("react.memo_cache_sentinel")?(h=[c("MAWMediaDownloadStatus").MISSING_FILE,c("MAWMediaDownloadStatus").MANUAL_RETRYABLE_FAILURE,c("MAWMediaDownloadStatus").DOWNLOADING].filter(Boolean),g[0]=h):h=g[0];var k=h;g[1]!==a||g[2]!==e||g[3]!==f?(h=new Map(f==null?void 0:f.map(function(b,c){var f=(!d("MAWMediaManagerUiIntegrationCheck").getIsMediaManagerUiIntegrationEnabled()||e==null||e==="fullsize"||e==="fullsizeAndPreview")&&k.includes(b==null?void 0:b.mainMediaStatus);b=d("MAWMediaManagerUiIntegrationCheck").getIsMediaManagerUiIntegrationEnabled()&&e==="preview"&&k.includes(b==null?void 0:b.previewMediaStatus);b=b||f;return[a[c].attachment.attachmentFbid,b]})),g[1]=a,g[2]=e,g[3]=f,g[4]=h):h=g[4];f=h;var l=f;g[5]===Symbol["for"]("react.memo_cache_sentinel")?(h=new Map(),g[5]=h):h=g[5];var m=j(h),n=c("useAsyncReStore")();g[6]!==a||g[7]!==n||g[8]!==e||g[9]!==l||g[10]!==b?(f=function(){var c=[];a.forEach(function(a){var b,d,e=a.attachment;a=a.mediaRenderQpl;b=(b=l.get(e.attachmentFbid))!=null?b:!1;d=(d=m.current.get(e.attachmentFbid))!=null?d:!1;b&&!d&&(m.current.set(e.attachmentFbid,!0),c.push({attachment:e,mediaRenderQpl:a}))});c.length>0&&d("MAWDownloadMediaInWorkerDeferred").maybeBulkDownloadMediaInWorker({attachmentsWithQpl:c,dbPromise:n,downloadType:e,triggerUIView:b})},h=[a,n,e,m,l,b],g[6]=a,g[7]=n,g[8]=e,g[9]=l,g[10]=b,g[11]=f,g[12]=h):(f=g[11],h=g[12]);i(f,h)}g["default"]=a}),98);
__d("MWChatAttachmentMediaState.react",["$InternalEnum","I64","LSIntEnum","MAWClientMediaStatusUtils","MAWMediaManagerUiIntegrationCheck","MAWVideoAudioPlaybackErrorHandlerUtils","MessagingAttachmentType","RavenMessagingState","filterNulls","gkx","react","useClientMediaStatus","useMAWBulkMaybeAutoTriggerDownload","usePrevious"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j,k=h||(h=d("react"));e=h;var l=e.createContext,m=e.useEffect,n=e.useMemo,o=e.useState,p=b("$InternalEnum")({Image:0,Video:1,AnimatedImage:2}),q=l({canMoveBackward:!1,canMoveForward:!1,card:void 0,cards:[],currentIndex:0,isImageExpanded:!1,moveBackward:function(){},moveForward:function(){},moveTo:function(){},numberOfCards:0,setIsImageExpanded:function(){},shouldTriggerLoadMore:!1});function r(a){var b=a.attachmentType;a=a.ephemeralMediaState;return a!=null&&(i||(i=d("I64"))).equal(b,(j||(j=d("LSIntEnum"))).ofNumber(c("MessagingAttachmentType").EPHEMERAL_IMAGE))&&(i||(i=d("I64"))).equal(a,(j||(j=d("LSIntEnum"))).ofNumber(c("RavenMessagingState").PERMANENT))}function s(a){var b=a.attachmentType;a=a.ephemeralMediaState;return a!=null&&(i||(i=d("I64"))).equal(b,(j||(j=d("LSIntEnum"))).ofNumber(c("MessagingAttachmentType").EPHEMERAL_VIDEO))&&(i||(i=d("I64"))).equal(a,(j||(j=d("LSIntEnum"))).ofNumber(c("RavenMessagingState").PERMANENT))}function t(a,b,c,d){return c?d.hasMedia:b(d,"isPlayableMedia")!=null&&a(d,"isPlayableMedia")!=null}function u(a,b,e,f){var g=f.attachmentType;return!t(a,b,e,f)?!1:r(f)||(i||(i=d("I64"))).equal(g,(j||(j=d("LSIntEnum"))).ofNumber(c("MessagingAttachmentType").IMAGE))}function v(a,b,e,f,g){var h=f.attachmentFbid,k=f.attachmentType,l=!1,m=!1;g=d("MAWClientMediaStatusUtils").getStatusDataFromLsdb({clientMediaStatus:g,statusKey:h});h=g.hasStatus;g=g.statusData;if(h&&!c("gkx")("17009")){h=g!=null?g:{};g=h.validationResult;l=g!=null?d("MAWVideoAudioPlaybackErrorHandlerUtils").isInvalidVideo(f,g):!1;m=g!=null?d("MAWVideoAudioPlaybackErrorHandlerUtils").isUnsupportedVideo(f,g):!1}return!t(a,b,e,f)||l||m?!1:s(f)||(i||(i=d("I64"))).equal(k,(j||(j=d("LSIntEnum"))).ofNumber(c("MessagingAttachmentType").VIDEO))}function w(a,b){m(function(){a.forEach(function(a){try{a.attachment.hasMedia&&!(i||(i=d("I64"))).equal(a.attachment.attachmentType,(j||(j=d("LSIntEnum"))).ofNumber(c("MessagingAttachmentType").ANIMATED_IMAGE))&&b(a.attachment,"usePreloadThumbnails");return}catch(a){return}})},[a,b])}function a(a){var b=a.attachments,e=a.children,f=a.getIsSecureThread,g=a.getPlayableUrl,h=a.getPreviewUrl;a=a.initialAttachment;a=o(a);var i=a[0],j=a[1];a=o(!1);var l=a[0],m=a[1];a=c("usePrevious")(i==null?void 0:i.messageId);var r=n(function(){return b.map(function(a){return{attachment:a,mediaRenderQpl:null,statusKey:a.attachmentFbid}})},[b]),s=c("useClientMediaStatus")(r),t=n(function(){return i!=null&&d("MAWMediaManagerUiIntegrationCheck").getIsMediaManagerUiIntegrationEnabled()?[{attachment:i,mediaRenderQpl:null,statusKey:i.attachmentFbid}]:[]},[i]);c("useMAWBulkMaybeAutoTriggerDownload")(r,"fullsize","preview",s);c("useMAWBulkMaybeAutoTriggerDownload")(t,"fullsize","fullsizeAndPreview",s);var x=n(function(){return c("filterNulls")(b.map(function(a){var b=f(a);if(u(g,h,b,a))return{attachment:a,type:p.Image};return v(g,h,b,a,s)?{attachment:a,type:p.Video}:null}))},[b,s,f,g,h]),y=i==null?-1:x.findIndex(function(a){return a.attachment.attachmentFbid===i.attachmentFbid&&a.attachment.messageId===i.messageId}),z=a!=null&&(i==null?void 0:i.messageId)!==a&&y>x.length-5;w(x,h);r=n(function(){var a=Math.max(0,x.length-1);return{canMoveBackward:y>0&&y!==-1,canMoveForward:y<a&&y!==-1,card:x[y],cards:x,currentIndex:y,isImageExpanded:l,moveBackward:function(){var a=Math.max(y-1,0);j((a=x[a])==null?void 0:a.attachment)},moveForward:function(){var b=Math.min(y+1,a);j((b=x[b])==null?void 0:b.attachment)},moveTo:function(a){j(a.attachment)},numberOfCards:x.length,setIsImageExpanded:m,shouldTriggerLoadMore:z}},[x,y,z,l]);return k.jsx(q.Provider,{value:r,children:e})}a.displayName=a.name+" [from "+f.id+"]";g.AttachmentMediaType=p;g.context=q;g.MWChatAttachmentMediaStateProviderFromAttachments=a}),98);
__d("MWChatAttachmentMediaNavigationHotkeys.react",["fbt","CometKeys","MWChatAttachmentMediaState.react","justknobx","react","react-compiler-runtime","useLayerKeyCommands"],(function(a,b,c,d,e,f,g,h){"use strict";var i,j=i||(i=d("react"));b=i;var k=b.useContext;b.useMemo;var l={key:c("CometKeys").LEFT},m={key:c("CometKeys").RIGHT},n={key:c("CometKeys").ESCAPE},o=h._(/*BTDS*/"Next item"),p=h._(/*BTDS*/"Previous item"),q=h._(/*BTDS*/"Close");function a(a){var b=d("react-compiler-runtime").c(18),e=a.children,f=a.onClose;a=k(d("MWChatAttachmentMediaState.react").context);var g=a.isImageExpanded,h=a.moveBackward,i=a.moveForward,r=a.setIsImageExpanded;b[0]!==g||b[1]!==h?(a={command:l,description:o,handler:function(){g||h()}},b[0]=g,b[1]=h,b[2]=a):a=b[2];var s;b[3]!==g||b[4]!==i?(s={command:m,description:p,handler:function(){g||i()}},b[3]=g,b[4]=i,b[5]=s):s=b[5];var t;b[6]!==g||b[7]!==f||b[8]!==r?(t=f!=null?{command:n,description:q,handler:function(){if(g)return r(!1);f()}}:null,b[6]=g,b[7]=f,b[8]=r,b[9]=t):t=b[9];var u;b[10]!==a||b[11]!==s||b[12]!==t?(u=[a,s,t],b[10]=a,b[11]=s,b[12]=t,b[13]=u):u=b[13];a=u;b[14]!==a?(s=a.filter(Boolean),b[14]=a,b[15]=s):s=b[15];t=s;u=t;c("useLayerKeyCommands")(u);b[16]!==e?(a=c("justknobx")._("3491")?j.jsx(j.Fragment,{children:e!=null?e:null}):j.jsx("div",{children:e!=null?e:null}),b[16]=e,b[17]=a):a=b[17];return a}g.keyLeft=l;g.keyRight=m;g.keyEscape=n;g.MWChatAttachmentMediaNavigationHotkeys=a}),226);
__d("MWChatAttachmentMediaUtils",["MWChatAttachmentMediaState.react"],(function(a,b,c,d,e,f,g){"use strict";var h="/images/comet/gray.png";function a(a){var b=a.card,c=a.getPlayableUrl;a=a.getPreviewUrl;var e=b.attachment,f;if(e.hasMedia)try{f=a(e,"toFilmstripThumbnail")}catch(a){f=null}a=f;if(b.type===d("MWChatAttachmentMediaState.react").AttachmentMediaType.Video&&f==null)try{a=c(e,"toFilmstripThumbnail")}catch(b){a=null}if(b.type===d("MWChatAttachmentMediaState.react").AttachmentMediaType.Image){return{alt:(c=e.accessibilitySummaryText)!=null?c:"",backgroundColor:void 0,height:0,isUseImageResizing:void 0,mediaType:"image",uri:f!=null?f:h,width:0}}return{height:0,mediaType:"video",thumbnailUri:f!=null?f:h,uri:a!=null?a:h,width:0}}function b(a){var b=a.card,c=a.getPlayableUrl;a=a.getPreviewUrl;var e=b.attachment,f;e.hasMedia&&(f=a(e,"toFilmstripThumbnailSuspends"));a=f;b.type===d("MWChatAttachmentMediaState.react").AttachmentMediaType.Video&&f==null&&(a=c(e,"toFilmstripThumbnailSuspends"));if(b.type===d("MWChatAttachmentMediaState.react").AttachmentMediaType.Image){return{alt:(c=e.accessibilitySummaryText)!=null?c:"",backgroundColor:void 0,height:0,isUseImageResizing:void 0,mediaType:"image",uri:f!=null?f:h,width:0}}return{height:0,mediaType:"video",thumbnailUri:f!=null?f:h,uri:a!=null?a:h,width:0}}g.loadingStateUri=h;g.toFilmstripThumbnail=a;g.toFilmstripThumbnailSuspends=b}),98);
__d("MWV2MediaViewerContext.react",["react","react-compiler-runtime"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h||(h=d("react"));h.useMemo;var j=i.createContext({getDownloadUrl:function(){},getPlayableUrl:function(){},getPreviewUrl:function(){},heroLoggingComponent:function(a){return null},loadMore:function(){},media:[]});function a(a){var b=d("react-compiler-runtime").c(10),c=a.children,e=a.getDownloadUrl,f=a.getPlayableUrl,g=a.getPreviewUrl,h=a.heroLoggingComponent,k=a.loadMore;a=a.media;var l;b[0]!==e||b[1]!==f||b[2]!==g||b[3]!==h||b[4]!==k||b[5]!==a?(l={getDownloadUrl:e,getPlayableUrl:f,getPreviewUrl:g,heroLoggingComponent:h,loadMore:k,media:a},b[0]=e,b[1]=f,b[2]=g,b[3]=h,b[4]=k,b[5]=a,b[6]=l):l=b[6];e=l;f=e;b[7]!==c||b[8]!==f?(g=i.jsx(j.Provider,{value:f,children:c}),b[7]=c,b[8]=f,b[9]=g):g=b[9];return g}g.context=j;g.MWV2MediaViewerContextProvider=a}),98);
__d("MWChatAttachmentMediaThumbnails.react",["CometMediaViewerFilmstrip.react","CometPlaceholder.react","MWChatAttachmentMediaState.react","MWChatAttachmentMediaUtils","MWV2MediaViewerContext.react","react","react-compiler-runtime"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h||(h=d("react"));b=h;var j=b.useContext,k=b.useDeferredValue;function l(a){var b,e,f=d("react-compiler-runtime").c(23),g=a.activeCard,h=a.cards,k=a.getPreviewUrl,l=a.onSetImage,m=j(d("MWV2MediaViewerContext.react").context);f[0]!==m?(a=function(a,b){return a==null?"":m.getDownloadUrl(a,b)},f[0]=m,f[1]=a):a=f[1];var n=a;if(f[2]!==h||f[3]!==n||f[4]!==k){f[6]!==n||f[7]!==k?(a=function(a){return d("MWChatAttachmentMediaUtils").toFilmstripThumbnail({card:a,getPlayableUrl:n,getPreviewUrl:k})},f[6]=n,f[7]=k,f[8]=a):a=f[8];a=h.map(a);f[2]=h;f[3]=n;f[4]=k;f[5]=a}else a=f[5];a=a;if(f[9]!==(g==null||(b=g.attachment)==null?void 0:b.attachmentFbid)||f[10]!==(g==null||(e=g.attachment)==null?void 0:e.messageId)||f[11]!==h){var o,p,q,r,s;if(f[13]!==(g==null||(o=g.attachment)==null?void 0:o.attachmentFbid)||f[14]!==(g==null||(p=g.attachment)==null?void 0:p.messageId)){var t,u;s=function(a){var b,c;return a.attachment.attachmentFbid===(g==null||(b=g.attachment)==null?void 0:b.attachmentFbid)&&a.attachment.messageId===(g==null||(c=g.attachment)==null?void 0:c.messageId)};f[13]=g==null||(t=g.attachment)==null?void 0:t.attachmentFbid;f[14]=g==null||(u=g.attachment)==null?void 0:u.messageId;f[15]=s}else s=f[15];s=h.findIndex(s);f[9]=g==null||(q=g.attachment)==null?void 0:q.attachmentFbid;f[10]=g==null||(r=g.attachment)==null?void 0:r.messageId;f[11]=h;f[12]=s}else s=f[12];s=s;var v;f[16]!==h||f[17]!==l?(v=function(a){return l(h[a])},f[16]=h,f[17]=l,f[18]=v):v=f[18];var w;f[19]!==s||f[20]!==a||f[21]!==v?(w=i.jsx(c("CometMediaViewerFilmstrip.react"),{activeIndex:s,images:a,onSetImage:v}),f[19]=s,f[20]=a,f[21]=v,f[22]=w):w=f[22];return w}function a(a){var b=d("react-compiler-runtime").c(10),e=a.getPreviewUrl;a=a.shouldHide;a=a===void 0?!1:a;var f=j(d("MWChatAttachmentMediaState.react").context),g=f.card,h=f.cards;f=f.moveTo;h=k(h);var m;b[0]!==a?(m={0:{className:"xdj266r x11t971q xat24cr xvc5jky x193iq5w x6ikm8r x10wlt62"},1:{className:"xdj266r x11t971q xat24cr xvc5jky x193iq5w x6ikm8r x10wlt62 x1s85apg"}}[!!a<<0],b[0]=a,b[1]=m):m=b[1];b[2]!==g||b[3]!==h||b[4]!==e||b[5]!==f?(a=i.jsx(c("CometPlaceholder.react"),{fallback:null,name:"MWChatAttachmentMediaThumbnails",children:i.jsx(l,{activeCard:g,cards:h,getPreviewUrl:e,onSetImage:f})}),b[2]=g,b[3]=h,b[4]=e,b[5]=f,b[6]=a):a=b[6];b[7]!==m||b[8]!==a?(g=i.jsx("div",babelHelpers["extends"]({},m,{"data-testid":void 0,children:a})),b[7]=m,b[8]=a,b[9]=g):g=b[9];return g}g["default"]=a}),98);
__d("MWMediaViewerRenderQpl",["MWMediaRenderQplUtils"],(function(a,b,c,d,e,f,g){"use strict";function a(a,b){return d("MWMediaRenderQplUtils").useCommonMediaRenderQplForAttachment(a,b,"full_screen_view")}g.useMediaViewerRenderQpl=a}),98);
__d("MWMessageSearchStatusTypes",["$InternalEnum"],(function(a,b,c,d,e,f){"use strict";a=b("$InternalEnum").Mirrored(["IN_PROGRESS","COMPLETE","NOT_RUNNING","NOT_REQUIRED"]);c=b("$InternalEnum").Mirrored(["IN_PROGRESS","COMPLETE","NOT_STARTED"]);d=b("$InternalEnum").Mirrored(["NOT_STARTED","IN_PROGRESS","COMPLETE","FAILED"]);f.RestoreStatus=a;f.OverallStatus=c;f.PrimarySearchStatus=d}),66);
__d("MWSharedAttachmentsSectionHooks",["I64","LSIntEnum","LSThreadMediaGalleryGroup","MessagingAttachmentType","ReQL","ReQLSuspense","react","react-compiler-runtime","usePrevious","useReStore"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j,k,l=k||d("react");l.useCallback;var m=l.useEffect,n=l.useState;function a(a){var b=d("react-compiler-runtime").c(33),e=a.attachmentsRange,f=a.hasMore,g=a.loadMore,h=a.logLoadMediaCancel,i=a.logLoadMediaSuccess,j=a.media,k=a.skipInitialLoad;a=n(!1);var l=a[0],o=a[1],p=j.length,q=(a=c("usePrevious")(p))!=null?a:0,r=c("usePrevious")(f),s=(j=c("usePrevious")(l))!=null?j:!1,t=e!=null;b[0]!==t||b[1]!==g||b[2]!==k?(a=function(){!t&&k!==!0&&(g(),o(!0))},j=[t,g,k],b[0]=t,b[1]=g,b[2]=k,b[3]=a,b[4]=j):(a=b[3],j=b[4]);m(a,j);b[5]!==e||b[6]!==f||b[7]!==l||b[8]!==g||b[9]!==i||b[10]!==p||b[11]!==r||b[12]!==s||b[13]!==q?(a=function(){var a=q!==p,b=r===!0&&!f||e==null&&f===!1&&r===!1&&q===p;l&&(b||a)?(o(!1),i==null||i({fetchedMediaCount:p-q,startMediaCount:q})):q===p&&f&&l&&s===!0&&(i==null||i({fetchedMediaCount:p-q,isAlreadyPreloaded:!0,startMediaCount:q}),g())},b[5]=e,b[6]=f,b[7]=l,b[8]=g,b[9]=i,b[10]=p,b[11]=r,b[12]=s,b[13]=q,b[14]=a):a=b[14];b[15]!==e||b[16]!==f||b[17]!==l||b[18]!==g||b[19]!==h||b[20]!==i||b[21]!==p||b[22]!==r||b[23]!==s||b[24]!==q?(j=[p,f,l,q,r,e,g,s,i,h],b[15]=e,b[16]=f,b[17]=l,b[18]=g,b[19]=h,b[20]=i,b[21]=p,b[22]=r,b[23]=s,b[24]=q,b[25]=j):j=b[25];m(a,j);b[26]!==l||b[27]!==g?(h=function(){if(!l){g();return o(!0)}},b[26]=l,b[27]=g,b[28]=h):h=b[28];a=h;j=p>0||!l&&!f;b[29]!==j||b[30]!==l||b[31]!==a?(h=[l,a,j],b[29]=j,b[30]=l,b[31]=a,b[32]=h):h=b[32];return h}function o(a,b,e,g){var i=d("react-compiler-runtime").c(19),j;i[0]!==g?(j=g===void 0?{}:g,i[0]=g,i[1]=j):j=i[1];g=j;j=g.removeUnsentMessages;var k=j===void 0?!1:j,l=(h||(h=c("useReStore")))();g=t(a,b);j=g.attachmentsRange;b=g.hasMoreBefore;var m=g.minTimestampMs,n=g.query;i[2]!==l||i[3]!==e||i[4]!==k?(g=function(a){if(!e(a))return null;if(!k)return a;var b=d("ReQLSuspense").first(d("ReQL").fromTableAscending(l.tables.messages.index("messageId")).getKeyRange(a.messageId),f.id+":146");return b==null||b.isUnsent?null:a},i[2]=l,i[3]=e,i[4]=k,i[5]=g):g=i[5];var o=g;i[6]!==o||i[7]!==n?(g=function(){return n.map(o).filter(Boolean)},i[6]=o,i[7]=n,i[8]=g):g=i[8];var p;i[9]!==l||i[10]!==m||i[11]!==o||i[12]!==a?(p=[l,a,o,m],i[9]=l,i[10]=m,i[11]=o,i[12]=a,i[13]=p):p=i[13];a=d("ReQLSuspense").useArray(g,p,f.id+":159");i[14]!==a||i[15]!==j||i[16]!==b||i[17]!==m?(g=[a,j,m,b],i[14]=a,i[15]=j,i[16]=b,i[17]=m,i[18]=g):g=i[18];return g}function p(a){var b=a.attachmentType;a=a.defaultCtaType;return(i||(i=d("I64"))).equal(b,(j||(j=d("LSIntEnum"))).ofNumber(c("MessagingAttachmentType").XMA))?a==="xma_web_url"||a==="xma_open_native":!1}function b(a,b){var e=d("react-compiler-runtime").c(7),f;e[0]===Symbol["for"]("react.memo_cache_sentinel")?(f=(j||(j=d("LSIntEnum"))).ofNumber(c("LSThreadMediaGalleryGroup").LINKS),e[0]=f):f=e[0];a=o(a,f,p,b);f=a[0];b=a[1];var g=a[2];a=a[3];var h;e[1]===Symbol["for"]("react.memo_cache_sentinel")?(h=(j||(j=d("LSIntEnum"))).ofNumber(c("LSThreadMediaGalleryGroup").LINKS),e[1]=h):h=e[1];e[2]!==f||e[3]!==b||e[4]!==a||e[5]!==g?(h=[f,h,b,g,a],e[2]=f,e[3]=b,e[4]=a,e[5]=g,e[6]=h):h=e[6];return h}function q(a){a=a.attachmentType;return(i||(i=d("I64"))).equal(a,(j||(j=d("LSIntEnum"))).ofNumber(c("MessagingAttachmentType").IMAGE))||(i||(i=d("I64"))).equal(a,(j||(j=d("LSIntEnum"))).ofNumber(c("MessagingAttachmentType").VIDEO))}function e(a,b){var e=d("react-compiler-runtime").c(7),f;e[0]===Symbol["for"]("react.memo_cache_sentinel")?(f=(j||(j=d("LSIntEnum"))).ofNumber(c("LSThreadMediaGalleryGroup").PHOTOS_AND_VIDEOS),e[0]=f):f=e[0];a=o(a,f,q,b);f=a[0];b=a[1];var g=a[2];a=a[3];var h;e[1]===Symbol["for"]("react.memo_cache_sentinel")?(h=(j||(j=d("LSIntEnum"))).ofNumber(c("LSThreadMediaGalleryGroup").PHOTOS_AND_VIDEOS),e[1]=h):h=e[1];e[2]!==f||e[3]!==b||e[4]!==a||e[5]!==g?(h=[f,h,b,g,a],e[2]=f,e[3]=b,e[4]=a,e[5]=g,e[6]=h):h=e[6];return h}function r(a){a=a.attachmentType;return(i||(i=d("I64"))).equal(a,(j||(j=d("LSIntEnum"))).ofNumber(c("MessagingAttachmentType").FILE))}function s(a,b){var e=d("react-compiler-runtime").c(7),f;e[0]===Symbol["for"]("react.memo_cache_sentinel")?(f=(j||(j=d("LSIntEnum"))).ofNumber(c("LSThreadMediaGalleryGroup").FILES_ONLY),e[0]=f):f=e[0];a=o(a,f,r,b);f=a[0];b=a[1];var g=a[2];a=a[3];var h;e[1]===Symbol["for"]("react.memo_cache_sentinel")?(h=(j||(j=d("LSIntEnum"))).ofNumber(c("LSThreadMediaGalleryGroup").FILES_ONLY),e[1]=h):h=e[1];e[2]!==f||e[3]!==b||e[4]!==a||e[5]!==g?(h=[f,h,b,g,a],e[2]=f,e[3]=b,e[4]=a,e[5]=g,e[6]=h):h=e[6];return h}function t(a,b){var e=d("react-compiler-runtime").c(17),g=(h||(h=c("useReStore")))(),j;e[0]!==g.tables.attachments_ranges_v2__generated||e[1]!==b||e[2]!==a?(j=function(){return d("ReQL").fromTableDescending(g.tables.attachments_ranges_v2__generated).getKeyRange(a).filter(function(a){return(i||(i=d("I64"))).equal(a.mediaGroup,b)})},e[0]=g.tables.attachments_ranges_v2__generated,e[1]=b,e[2]=a,e[3]=j):j=e[3];var k;e[4]!==g||e[5]!==b||e[6]!==a?(k=[g,a,b],e[4]=g,e[5]=b,e[6]=a,e[7]=k):k=e[7];j=d("ReQLSuspense").useFirst(j,k,f.id+":284");k=j==null?void 0:j.minTimestampMs;var l=j==null?void 0:j.hasMoreBefore;if(e[8]!==g.tables.attachments||e[9]!==k||e[10]!==a){var m=d("ReQL").fromTableDescending(g.tables.attachments.index("fk_messages")).getKeyRange(a);m=k!=null&&(i||(i=d("I64"))).to_float(k)!==Number.MAX_SAFE_INTEGER?m.bounds({gte:d("ReQL").key(k)}):m;e[8]=g.tables.attachments;e[9]=k;e[10]=a;e[11]=m}else m=e[11];m=m;var n;e[12]!==j||e[13]!==l||e[14]!==k||e[15]!==m?(n={attachmentsRange:j,hasMoreBefore:l,minTimestampMs:k,query:m},e[12]=j,e[13]=l,e[14]=k,e[15]=m,e[16]=n):n=e[16];return n}g.useLoader=a;g.useQueryLinkAttachments=b;g.filterMediaAttachments=q;g.useQueryMediaAttachments=e;g.useQueryFileAttachments=s;g.useAttachmentsQuery=t}),98);
__d("useLoadMoreThreadSharedAttachments.react",["Int64Hooks","LSFactory","LSIssueAttachmentsRangeQueryStoredProcedure","MAWThreadCutover","MWThreadKey.react","promiseDone","react-compiler-runtime","useAsyncReStore"],(function(a,b,c,d,e,f,g){"use strict";function a(a,b,e){var g=d("react-compiler-runtime").c(6),h=c("useAsyncReStore")(),i=d("MWThreadKey.react").useMWThreadKeyMemoized();i==null&&(i=b);b=d("MAWThreadCutover").useGetCutoverOpenThreadKey(i);var j=b!=null?b:i;g[0]!==h||g[1]!==j||g[2]!==e||g[3]!==a?(b=function(){e==null||e(),c("promiseDone")(h,function(b){return b.runInTransaction(function(b){return c("LSIssueAttachmentsRangeQueryStoredProcedure")(c("LSFactory")(b),{mediaGroup:a,threadKey:j})},"readwrite",void 0,void 0,f.id+":40")})},i=[e,h,a,j],g[0]=h,g[1]=j,g[2]=e,g[3]=a,g[4]=b,g[5]=i):(b=g[4],i=g[5]);return d("Int64Hooks").useCallbackInt64(b,i)}g["default"]=a}),98);
__d("useMAWLoadMoreThreadSharedAttachments",["I64","Int64Hooks","MAWBridgeSendAndReceive","MAWMediaGalleryEBTaggingUtils","MAWMiActOnActThreadReady","Promise","cr:20241","promiseDone","react-compiler-runtime","useReStore"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j;function a(a){var e=d("react-compiler-runtime").c(16),f=a.earliestLoadedMediaMessageId,g=a.hasMoreBefore,k=a.mediaGalleryGroup,l=a.minTimestampMs,m=a.pageSize,n=a.qplLogger,o=a.threadKey,p=(j||(j=c("useReStore")))(),q;e[0]!==g||e[1]!==l?(a=function(){return g!=null&&g&&l!=null?(i||(i=d("I64"))).to_float(l):Number.MAX_SAFE_INTEGER},q=[g,l],e[0]=g,e[1]=l,e[2]=a,e[3]=q):(a=e[2],q=e[3]);var r=d("Int64Hooks").useCallbackInt64(a,q);e[4]!==k?(a=d("MAWMediaGalleryEBTaggingUtils").isMediaGalleryGroupSupportedForTaggedRestore(k),e[4]=k,e[5]=a):a=e[5];var s=a;e[6]!==p.tables||e[7]!==f||e[8]!==r||e[9]!==s||e[10]!==k||e[11]!==m||e[12]!==n||e[13]!==o?(q=function(){o!=null&&(n==null||n.logLoadMediaStart==null||n.logLoadMediaStart(),c("promiseDone")(d("MAWMiActOnActThreadReady").onActThreadReady(p.tables,o,"useMAWLoadMoreThreadSharedAttachments",function(a,c){return(b("cr:20241")!=null&&s?b("cr:20241").MAWFetchAndPersistMedia(c,o,k,n):(h||(h=b("Promise"))).resolve()).then(function(){n==null||n.addPoint("fetch_from_maw_db",{"int":{mediaGalleryGroup:k}});return d("MAWBridgeSendAndReceive").sendAndReceive("backend","loadMoreMedia",{earliestLoadedMediaMessageId:f,earliestLoadedMediaTs:r(),mediaGalleryGroup:k,pageSize:m,threadJid:c})})})))},a=[o,p.tables,s,k,n,f,r,m],e[6]=p.tables,e[7]=f,e[8]=r,e[9]=s,e[10]=k,e[11]=m,e[12]=n,e[13]=o,e[14]=q,e[15]=a):(q=e[14],a=e[15]);return d("Int64Hooks").useCallbackInt64(q,a)}g["default"]=a}),98);
__d("useMAWQuerySecureMediaAttachments",["I64","LSIntEnum","LSThreadMediaGalleryGroup","MWSharedAttachmentsSectionHooks","ReQL","ReQLSuspense","justknobx","react","useReStore"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j,k;b=k||d("react");var l=b.useCallback,m=b.useMemo;function a(a,b,e){e=e===void 0?{}:e;e=e.removeUnsentMessages;var g=e===void 0?!1:e,k=(h||(h=c("useReStore")))(),o=b==null?c("justknobx")._("1132"):b;e=d("MWSharedAttachmentsSectionHooks").useAttachmentsQuery(a,(i||(i=d("LSIntEnum"))).ofNumber(c("LSThreadMediaGalleryGroup").PHOTOS_AND_VIDEOS));b=e.attachmentsRange;var q=e.hasMoreBefore,r=e.minTimestampMs,s=e.query,t=l(function(a){if(!d("MWSharedAttachmentsSectionHooks").filterMediaAttachments(a))return null;var b=d("ReQLSuspense").first(d("ReQL").fromTableAscending(k.tables.messages.index("messageId")).getKeyRange(a.messageId),f.id+":77");if(g&&(b==null||b.isUnsent))return null;return b==null?{attachment:a}:{attachment:a,message:b}},[k,g]),u=d("ReQLSuspense").useArray(function(){var a=s.map(t).filter(Boolean);(r==null||(j||(j=d("I64"))).equal(r,(j||(j=d("I64"))).zero))&&(a=a.take(o));return a},[k,a,t,r],f.id+":95"),v=m(function(){var a=n(u);a.sort(p);return a},[u]);e=m(function(){return v.map(function(a){a=a.attachment;return a})},[v]);return[e,i.ofNumber(c("LSThreadMediaGalleryGroup").PHOTOS_AND_VIDEOS),b,r,q]}function n(a){var b=o(a);return a.map(function(a){var c=a.attachment;a=a.message;var e=a==null?void 0:a.groupId,f=b.get(e!=null?e:"");if(e==null||f==null){return{attachment:c,message:a,sortKey:{sortingMessageGroupIndex:Number.MAX_SAFE_INTEGER,sortingMessageId:c.messageId,sortingMessagePrimarySortTS:(e=a==null?void 0:a.primarySortKey)!=null?e:c.timestampMs,sortingMessageSecondarySortTS:(e=(e=a==null?void 0:a.secondarySortKey)!=null?e:a==null?void 0:a.timestampMs)!=null?e:c.timestampMs}}}return{attachment:c,message:a,sortKey:{sortingMessageGroupIndex:(j||(j=d("I64"))).to_int32((e=a==null?void 0:a.groupIndex)!=null?e:(j||(j=d("I64"))).zero),sortingMessageId:f.messageId,sortingMessagePrimarySortTS:f.primarySortTs,sortingMessageSecondarySortTS:f.secondarySortTs}}})}function o(a){var b=new Map();a.forEach(function(a){var c;a=a.message;if(!a||a.groupId==null||a.groupIndex==null)return;var e=a.groupId,f=(j||(j=d("I64"))).to_int32(a.groupIndex);c=Math.min((c=(c=b.get(e))==null?void 0:c.groupIndex)!=null?c:Number.MAX_SAFE_INTEGER,f);f=f===c?{groupIndex:f,messageId:a.messageId,primarySortTs:a.primarySortKey,secondarySortTs:(c=a.secondarySortKey)!=null?c:a.timestampMs}:b.get(e);f&&b.set(e,f)});return b}function p(a,b){var c=a.sortKey,e=b.sortKey;a=a.message;b=b.message;if(!(j||(j=d("I64"))).equal(c.sortingMessagePrimarySortTS,e.sortingMessagePrimarySortTS))return(j||(j=d("I64"))).compare(e.sortingMessagePrimarySortTS,c.sortingMessagePrimarySortTS);if(!(j||(j=d("I64"))).equal(e.sortingMessageSecondarySortTS,c.sortingMessageSecondarySortTS))return(j||(j=d("I64"))).compare(e.sortingMessageSecondarySortTS,c.sortingMessageSecondarySortTS);if(c.sortingMessageId!==e.sortingMessageId)return e.sortingMessageId.localeCompare(c.sortingMessageId);return(a==null?void 0:a.groupId)!=null&&(b==null?void 0:b.groupId)!=null&&a.groupId===b.groupId?e.sortingMessageGroupIndex-c.sortingMessageGroupIndex:0}g["default"]=a}),98);
__d("useMWMediaLoadingQplLogger",["MWMediaRenderQplUtils","QPLUserFlow","QuickPerformanceLogger","Random","qpl","react","react-compiler-runtime"],(function(a,b,c,d,e,f,g){"use strict";var h,i;b=i||d("react");b.useCallback;var j=b.useEffect;b.useMemo;function a(a){var b=d("react-compiler-runtime").c(12),e=a.entrypoint,f=a.threadType;b[0]===Symbol["for"]("react.memo_cache_sentinel")?(a=p(),b[0]=a):a=b[0];a=a;var g=a;b[1]!==e||b[2]!==f?(a=function(a){var b;k({entrypoint:e,instanceKey:g,isCutoverThread:(b=a==null?void 0:a.isCutoverThread)!=null?b:!1,isPreCutoverMedia:(b=a==null?void 0:a.isPreCutoverMedia)!=null?b:!1,threadType:f})},b[1]=e,b[2]=f,b[3]=a):a=b[3];a=a;var i;b[4]===Symbol["for"]("react.memo_cache_sentinel")?(i=function(a){var b=a.fetchedMediaCount,c=a.isAlreadyPreloaded;a=a.startMediaCount;l({fetchedMediaCount:b,instanceKey:g,isAlreadyPreloaded:c,startMediaCount:a})},b[4]=i):i=b[4];i=i;var q;b[5]===Symbol["for"]("react.memo_cache_sentinel")?(q=function(){m({instanceKey:g})},b[5]=q):q=b[5];var r=q;b[6]===Symbol["for"]("react.memo_cache_sentinel")?(q=function(a,b){n({annotations:b,instanceKey:g,name:a})},b[6]=q):q=b[6];q=q;var s;b[7]===Symbol["for"]("react.memo_cache_sentinel")?(s=function(a){o({annotations:a,instanceKey:g})},b[7]=s):s=b[7];s=s;var t,u;b[8]===Symbol["for"]("react.memo_cache_sentinel")?(t=function(){return function(){var a=(h||(h=c("QuickPerformanceLogger"))).isMarkerOn(c("qpl")._(25300395,"1954"),g);a&&r()}},u=[g,r],b[8]=t,b[9]=u):(t=b[8],u=b[9]);j(t,u);b[10]!==a?(t={addAnnotations:s,addPoint:q,logLoadMediaCancel:r,logLoadMediaStart:a,logLoadMediaSuccess:i},b[10]=a,b[11]=t):t=b[11];u=t;return u}function k(a){var b=a.entrypoint,e=a.instanceKey,f=a.isCutoverThread;f=f===void 0?!1:f;var g=a.isPreCutoverMedia;g=g===void 0?!1:g;a=a.threadType;c("QPLUserFlow").start(c("qpl")._(25300395,"1954"),{annotations:{bool:{isCutoverThread:f,isPreCutoverMedia:g},string:{entrypoint:b,threadType:d("MWMediaRenderQplUtils").getThreadTypeStringFromEnum(a)}},cancelOnUnload:!0,instanceKey:e,timeoutInMs:60*1e3})}function l(a){var b=a.fetchedMediaCount,d=a.instanceKey,e=a.isAlreadyPreloaded;a=a.startMediaCount;c("QPLUserFlow").endSuccess(c("qpl")._(25300395,"1954"),{annotations:{bool:{isAlreadyPreloaded:e!=null?e:!1},"int":{fetchedMediaCount:b,startMediaCount:a}},instanceKey:d})}function m(a){a=a.instanceKey;c("QPLUserFlow").endCancel(c("qpl")._(25300395,"1954"),{instanceKey:a})}function n(a){var b=a.annotations,d=a.instanceKey;a=a.name;c("QPLUserFlow").addPoint(c("qpl")._(25300395,"1954"),a,{data:b,instanceKey:d})}function o(a){var b=a.annotations;a=a.instanceKey;c("QPLUserFlow").addAnnotations(c("qpl")._(25300395,"1954"),b,{instanceKey:a})}function p(){return Date.now()+Math.round(d("Random").random()*1e4)}g["default"]=a}),98);
__d("useMAWLoadMoreCutoverThreadSharedAttachments",["MAWDbMsg","MWSharedAttachmentsSectionHooks","gkx","react","react-compiler-runtime","useLoadMoreThreadSharedAttachments.react","useMAWLoadMoreThreadSharedAttachments","useMAWQuerySecureMediaAttachments","useMWMediaLoadingQplLogger"],(function(a,b,c,d,e,f,g){"use strict";var h;(h||d("react")).useCallback;function a(a,b,e,f,g,h,j){var k=d("react-compiler-runtime").c(55),l=c("useMAWQuerySecureMediaAttachments")(a,j),m=l[0],n=l[1],o=l[2],p=l[3];l=l[4];var q;k[0]!==(o==null?void 0:o.lastLoadedMessageId)?(q=(o==null?void 0:o.lastLoadedMessageId)!=null?d("MAWDbMsg").toMsgId(o==null?void 0:o.lastLoadedMessageId):void 0,k[0]=o==null?void 0:o.lastLoadedMessageId,k[1]=q):q=k[1];q=q;var r=l!=null?l:!0,s;k[2]!==f.entrypoint||k[3]!==e?(s={entrypoint:f.entrypoint,threadType:e},k[2]=f.entrypoint,k[3]=e,k[4]=s):s=k[4];var t=c("useMWMediaLoadingQplLogger")(s);k[5]!==t?(f=function(){t.logLoadMediaStart({isCutoverThread:!0,isPreCutoverMedia:!1})},k[5]=t,k[6]=f):f=k[6];e=f;s=q!=null?q:void 0;k[7]!==e||k[8]!==t?(f=babelHelpers["extends"]({},t,{logLoadMediaStart:e}),k[7]=e,k[8]=t,k[9]=f):f=k[9];k[10]!==l||k[11]!==g||k[12]!==p||k[13]!==j||k[14]!==a||k[15]!==s||k[16]!==f?(q={earliestLoadedMediaMessageId:s,hasMoreBefore:l,mediaGalleryGroup:g,minTimestampMs:p,pageSize:j,qplLogger:f,threadKey:a},k[10]=l,k[11]=g,k[12]=p,k[13]=j,k[14]=a,k[15]=s,k[16]=f,k[17]=q):q=k[17];e=c("useMAWLoadMoreThreadSharedAttachments")(q);l=d("MWSharedAttachmentsSectionHooks").useQueryMediaAttachments(b);g=l[0];p=l[2];j=l[4];a=j!=null?j:c("gkx")("6241");k[18]!==t?(s=function(){t.logLoadMediaStart({isCutoverThread:!0,isPreCutoverMedia:!0})},k[18]=t,k[19]=s):s=k[19];f=s;q=c("useLoadMoreThreadSharedAttachments.react")(n,b,f);k[20]!==o||k[21]!==r||k[22]!==e||k[23]!==m||k[24]!==t.logLoadMediaCancel||k[25]!==t.logLoadMediaSuccess?(l={attachmentsRange:o,hasMore:r,loadMore:e,logLoadMediaCancel:t.logLoadMediaCancel,logLoadMediaSuccess:t.logLoadMediaSuccess,media:m},k[20]=o,k[21]=r,k[22]=e,k[23]=m,k[24]=t.logLoadMediaCancel,k[25]=t.logLoadMediaSuccess,k[26]=l):l=k[26];j=d("MWSharedAttachmentsSectionHooks").useLoader(l);s=j[0];n=j[1];b=j[2];f=r||s;k[27]!==p||k[28]!==a||k[29]!==q||k[30]!==g||k[31]!==t.logLoadMediaCancel||k[32]!==t.logLoadMediaSuccess||k[33]!==f?(o={attachmentsRange:p,hasMore:a,loadMore:q,logLoadMediaCancel:t.logLoadMediaCancel,logLoadMediaSuccess:t.logLoadMediaSuccess,media:g,skipInitialLoad:f},k[27]=p,k[28]=a,k[29]=q,k[30]=g,k[31]=t.logLoadMediaCancel,k[32]=t.logLoadMediaSuccess,k[33]=f,k[34]=o):o=k[34];e=d("MWSharedAttachmentsSectionHooks").useLoader(o);l=e[0];j=e[1];p=e[2];if(r||s||h===!0){k[35]!==b||k[36]!==r||k[37]!==s||k[38]!==m||k[39]!==n?(q={attachments:m,completedFirstLoad:b,hasMore:r,isLoadingMore:s,onLoadMore:n},k[35]=b,k[36]=r,k[37]=s,k[38]=m,k[39]=n,k[40]=q):q=k[40];return q}else if(a||l){k[41]!==g||k[42]!==m?(f=m.concat(g),k[41]=g,k[42]=m,k[43]=f):f=k[43];k[44]!==p||k[45]!==a||k[46]!==l||k[47]!==j||k[48]!==f?(o={attachments:f,completedFirstLoad:p,hasMore:a,isLoadingMore:l,onLoadMore:j},k[44]=p,k[45]=a,k[46]=l,k[47]=j,k[48]=f,k[49]=o):o=k[49];return o}else{k[50]!==g||k[51]!==m?(e=m.concat(g),k[50]=g,k[51]=m,k[52]=e):e=k[52];k[53]!==e?(h={attachments:e,completedFirstLoad:!0,hasMore:!1,isLoadingMore:!1,onLoadMore:i},k[53]=e,k[54]=h):h=k[54];return h}}function i(){}g["default"]=a}),98);
__d("useMWMaybeInboxMediaRestoreLoop",["cr:20239","react-compiler-runtime"],(function(a,b,c,d,e,f,g){"use strict";function a(a){var c=d("react-compiler-runtime").c(2);a=b("cr:20239")(a);var e;c[0]!==a?(e=a!=null?a:{onEBOnboarded:i,startMediaSync:h},c[0]=a,c[1]=e):e=c[1];return e}function h(){}function i(){}g["default"]=a}),98);
__d("useMWMediaGalleryRestoreStatus",["Int64Hooks","LSMessagingThreadTypeUtil","MAWFTSRestoreSync","MAWMiActOnActThreadReady","MWEBEntrypointsKillswitch.enum","MWMessageSearchStatusTypes","cr:11999","justknobx","promiseDone","react","react-compiler-runtime","useMWEBBackupState","useReStore"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j=(i||d("react")).useState;function a(a){var e=d("react-compiler-runtime").c(12),f=a.threadKey;a=a.threadType;var g=(h||(h=c("useReStore")))(),i=j(null),l=i[0],m=i[1];e[0]===Symbol.for("react.memo_cache_sentinel")?(i={entrypoint:c("MWEBEntrypointsKillswitch.enum").MEDIA_GALLERY_RESTORE},e[0]=i):i=e[0];i=c("useMWEBBackupState")(i);var n=b("cr:11999")(l,"media"),o;e[1]!==a?(o=d("LSMessagingThreadTypeUtil").isArmadilloSecure(a),e[1]=a,e[2]=o):o=e[2];var p=o;e[3]===Symbol.for("react.memo_cache_sentinel")?(a=d("MAWFTSRestoreSync").getMediaRestoreSync(),e[3]=a):a=e[3];var q=a;e[4]===Symbol.for("react.memo_cache_sentinel")?(o=function(){return q.isStarted()},e[4]=o):o=e[4];a=j(o);o=a[0];var r=a[1];e[5]===Symbol.for("react.memo_cache_sentinel")?(a=function(){return q.isEBMaybeAvailable()},e[5]=a):a=e[5];a=j(a);var s=a[0],t=a[1];e[6]===Symbol.for("react.memo_cache_sentinel")?(a=function(){return q.getActiveThreadId()},e[6]=a):a=e[6];a=j(a);var u=a[0],v=a[1];a=j(-1);var w=a[0],x=a[1];a=j(!1);var y=a[0],z=a[1],A;e[7]!==g.tables||e[8]!==p||e[9]!==f?(a=function(){var a;(a=d("MAWFTSRestoreSync")).MAWGalleryEventEmitter.addListener("isSyncStarted",function(a){return r(a)});a.MAWGalleryEventEmitter.addListener("isEBMaybeAvailable",function(a){return t(a)});a.MAWGalleryEventEmitter.addListener("activeThreadJid",function(a){return v(a)});a.MAWGalleryEventEmitter.addListener("isPersisting",function(a){return z(a)});a.MAWGalleryEventEmitter.addListener("restoredUntilMs",function(a){x(a)});a=async function(){await d("MAWMiActOnActThreadReady").onActThreadReady(g.tables,f,"useMWMediaGalleryRestoreStatus",function(a,b){m(b);return Promise.resolve()})};p?c("promiseDone")(a()):m(null);return k},A=[g.tables,p,f],e[7]=g.tables,e[8]=p,e[9]=f,e[10]=a,e[11]=A):(a=e[10],A=e[11]);d("Int64Hooks").useEffectInt64(a,A);if(l!=null&&q.getDoneThreads().has(l))return d("MWMessageSearchStatusTypes").RestoreStatus.COMPLETE;e=l!=null&&u===l;if(!p)return d("MWMessageSearchStatusTypes").RestoreStatus.NOT_REQUIRED;if(i!==3)return d("MWMessageSearchStatusTypes").RestoreStatus.NOT_RUNNING;if(o){if(!s||!e)return d("MWMessageSearchStatusTypes").RestoreStatus.NOT_RUNNING;a=c("justknobx")._("3245")?w===0:n===0;return a&&!y?d("MWMessageSearchStatusTypes").RestoreStatus.COMPLETE:d("MWMessageSearchStatusTypes").RestoreStatus.IN_PROGRESS}else return d("MWMessageSearchStatusTypes").RestoreStatus.NOT_RUNNING}function k(){d("MAWFTSRestoreSync").MAWGalleryEventEmitter.removeAllListeners()}g.default=a}),98);
__d("useMWV2MediaViewerOpenPlayableUrl",["I64","LSIntEnum","LSMediaUrlAttachment","MessagingAttachmentType","react"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j;(h||d("react")).useCallback;function a(){return k}function k(a){if(a==null)return;return(i||(i=d("I64"))).equal(a.attachmentType,(j||(j=d("LSIntEnum"))).ofNumber(c("MessagingAttachmentType").ANIMATED_IMAGE))?d("LSMediaUrlAttachment").previewUrl(a):d("LSMediaUrlAttachment").playableUrl(a)}g["default"]=a}),98);
__d("useMWV2MediaViewerOpenDownloadUrl",["react","react-compiler-runtime","useMWV2MediaViewerOpenPlayableUrl"],(function(a,b,c,d,e,f,g){"use strict";var h;(h||d("react")).useCallback;function a(){var a=d("react-compiler-runtime").c(2),b=c("useMWV2MediaViewerOpenPlayableUrl")(),e;a[0]!==b?(e=function(a,c,d){a=b(a,c,d);if(a==null)return;c=new URL(a);c.searchParams.set("dl","1");return c.toString()},a[0]=b,a[1]=e):e=a[1];return e}g["default"]=a}),98);
__d("useMWV2MediaViewerOpenPreviewUrl",["LSMediaUrlAttachment","react"],(function(a,b,c,d,e,f,g){"use strict";var h;(h||d("react")).useCallback;function a(){return i}function i(a){return a!=null?d("LSMediaUrlAttachment").previewUrl(a):void 0}g["default"]=a}),98);
__d("useMWV2MediaViewerSecurePreviewUrl_CausesSuspense",["cr:5931","react"],(function(a,b,c,d,e,f,g){"use strict";var h;(h||d("react")).useCallback;function a(){return i}function i(a,c,d){return b("cr:5931")==null?void 0:b("cr:5931").getThumbnailBlob_CausesSuspense(a,c,d)}g["default"]=a}),98);
__d("MWV2MediaViewerCutoverWrapper.react",["LSThreadMediaGalleryGroup","MWChatAttachmentMediaState.react","MWMessageSearchStatusTypes","MWV2MediaViewerContext.react","emptyFunction","justknobx","react","react-compiler-runtime","useMAWLoadMoreCutoverThreadSharedAttachments","useMWMaybeInboxMediaRestoreLoop","useMWMediaGalleryRestoreStatus","useMWV2MediaViewerOpenDownloadUrl","useMWV2MediaViewerOpenPlayableUrl","useMWV2MediaViewerOpenPreviewUrl","useMWV2MediaViewerSecurePlayableUrl_CausesSuspense","useMWV2MediaViewerSecurePreviewUrl_CausesSuspense"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h||(h=d("react"));h.useCallback;function a(a){var b=d("react-compiler-runtime").c(30),e=a.children,f=a.initialAttachment,g=a.openThreadKey,h=a.secureThreadKey;a=a.threadType;var k;b[0]!==h||b[1]!==a?(k={threadKey:h,threadType:a},b[0]=h,b[1]=a,b[2]=k):k=b[2];c("useMWMaybeInboxMediaRestoreLoop")(k);b[3]!==h||b[4]!==a?(k={threadKey:h,threadType:a},b[3]=h,b[4]=a,b[5]=k):k=b[5];k=c("useMWMediaGalleryRestoreStatus")(k);k=k===d("MWMessageSearchStatusTypes").RestoreStatus.IN_PROGRESS;var l;b[6]===Symbol["for"]("react.memo_cache_sentinel")?(l={entrypoint:"media_viewer"},b[6]=l):l=b[6];var m;b[7]===Symbol["for"]("react.memo_cache_sentinel")?(m=c("justknobx")._("3233"),b[7]=m):m=b[7];h=c("useMAWLoadMoreCutoverThreadSharedAttachments")(h,g,a,l,c("LSThreadMediaGalleryGroup").PHOTOS_AND_VIDEOS,k,m);g=h.attachments;a=h.onLoadMore;var n=j,o=c("useMWV2MediaViewerOpenPreviewUrl")(),p=c("useMWV2MediaViewerOpenPlayableUrl")(),q=c("useMWV2MediaViewerOpenDownloadUrl")(),r=c("useMWV2MediaViewerSecurePreviewUrl_CausesSuspense")(),s=c("useMWV2MediaViewerSecurePlayableUrl_CausesSuspense")();b[8]!==o||b[9]!==r?(l=function(a,b,c){if(!a)return"";return!n(a)?o(a,b,c):r(a,b,c)},b[8]=o,b[9]=r,b[10]=l):l=b[10];k=l;b[11]!==p||b[12]!==s?(m=function(a,b,c){if(a==null)return"";return!n(a)?p(a,b,c):s(a,b,c)},b[11]=p,b[12]=s,b[13]=m):m=b[13];h=m;b[14]!==q||b[15]!==s?(l=function(a,b,c){if(a==null)return"";return!n(a)?q(a,b,c):s(a,b,c)},b[14]=q,b[15]=s,b[16]=l):l=b[16];m=l;b[17]!==g||b[18]!==e||b[19]!==h||b[20]!==k||b[21]!==f?(l=i.jsx(d("MWChatAttachmentMediaState.react").MWChatAttachmentMediaStateProviderFromAttachments,{attachments:g,getIsSecureThread:n,getPlayableUrl:h,getPreviewUrl:k,initialAttachment:f,children:e}),b[17]=g,b[18]=e,b[19]=h,b[20]=k,b[21]=f,b[22]=l):l=b[22];b[23]!==g||b[24]!==m||b[25]!==h||b[26]!==k||b[27]!==a||b[28]!==l?(e=i.jsx(d("MWV2MediaViewerContext.react").MWV2MediaViewerContextProvider,{getDownloadUrl:m,getPlayableUrl:h,getPreviewUrl:k,heroLoggingComponent:c("emptyFunction"),loadMore:a,media:g,children:l}),b[23]=g,b[24]=m,b[25]=h,b[26]=k,b[27]=a,b[28]=l,b[29]=e):e=b[29];return e}function j(a){return!((a==null?void 0:a.transportKey)==="FBBroker"||(a==null?void 0:a.transportKey)==="FBLegacyBroker")}g["default"]=a}),98);
__d("MWV2MediaViewerNullState.react",["fbt","CometColumn.react","CometColumnItem.react","FDSNullState.react","react","react-compiler-runtime"],(function(a,b,c,d,e,f,g,h){"use strict";var i,j=i||d("react");function a(){var a=d("react-compiler-runtime").c(1),b;a[0]===Symbol["for"]("react.memo_cache_sentinel")?(b=j.jsx(c("CometColumn.react"),{expanding:!0,verticalAlign:"center",children:j.jsx(c("CometColumnItem.react"),{children:j.jsx(c("FDSNullState.react"),{headline:h._(/*BTDS*/"Sorry, this content isn't available right now")})})}),a[0]=b):b=a[0];return b}g["default"]=a}),226);
__d("MWV2MediaViewerOpenWrapper.react",["CometHero.react","MWChatAttachmentMediaState.react","MWSharedAttachmentsSectionHooks","MWV2MediaViewerContext.react","react","react-compiler-runtime","useLoadMoreThreadSharedAttachments.react","useMWMediaLoadingQplLogger","useMWV2MediaViewerOpenDownloadUrl","useMWV2MediaViewerOpenPlayableUrl","useMWV2MediaViewerOpenPreviewUrl"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h||(h=d("react"));h.useCallback;function a(a){var b=d("react-compiler-runtime").c(22),e=a.children,f=a.initialAttachment;a=a.thread;var g=d("MWSharedAttachmentsSectionHooks").useQueryMediaAttachments(a.threadKey),h=g[0],l=g[1],m=g[2];g=g[4];var n;b[0]!==a.threadType?(n={entrypoint:"media_viewer",threadType:a.threadType},b[0]=a.threadType,b[1]=n):n=b[1];n=c("useMWMediaLoadingQplLogger")(n);l=c("useLoadMoreThreadSharedAttachments.react")(l,a.threadKey,n.logLoadMediaStart);a=g!=null?g:!0;b[2]!==m||b[3]!==l||b[4]!==h||b[5]!==n.logLoadMediaCancel||b[6]!==n.logLoadMediaSuccess||b[7]!==a?(g={attachmentsRange:m,hasMore:a,loadMore:l,logLoadMediaCancel:n.logLoadMediaCancel,logLoadMediaSuccess:n.logLoadMediaSuccess,media:h},b[2]=m,b[3]=l,b[4]=h,b[5]=n.logLoadMediaCancel,b[6]=n.logLoadMediaSuccess,b[7]=a,b[8]=g):g=b[8];m=d("MWSharedAttachmentsSectionHooks").useLoader(g);l=m[1];n=c("useMWV2MediaViewerOpenPreviewUrl")();a=c("useMWV2MediaViewerOpenPlayableUrl")();g=c("useMWV2MediaViewerOpenDownloadUrl")();m=k;b[9]!==e||b[10]!==a||b[11]!==n||b[12]!==f||b[13]!==h?(m=i.jsx(d("MWChatAttachmentMediaState.react").MWChatAttachmentMediaStateProviderFromAttachments,{attachments:h,getIsSecureThread:m,getPlayableUrl:a,getPreviewUrl:n,initialAttachment:f,children:e}),b[9]=e,b[10]=a,b[11]=n,b[12]=f,b[13]=h,b[14]=m):m=b[14];b[15]!==g||b[16]!==a||b[17]!==n||b[18]!==l||b[19]!==h||b[20]!==m?(e=i.jsx(d("MWV2MediaViewerContext.react").MWV2MediaViewerContextProvider,{getDownloadUrl:g,getPlayableUrl:a,getPreviewUrl:n,heroLoggingComponent:j,loadMore:l,media:h,children:m}),b[15]=g,b[16]=a,b[17]=n,b[18]=l,b[19]=h,b[20]=m,b[21]=e):e=b[21];return e}function j(a){return i.jsx(c("CometHero.react"),{description:a})}j.displayName=j.name+" [from "+f.id+"]";function k(){return!1}g["default"]=a}),98);
__d("MWV2MediaViewerSecureWrapper.react",["LSThreadMediaGalleryGroup","MAWDbMsg","MWChatAttachmentMediaState.react","MWSharedAttachmentsSectionHooks","MWV2MediaViewerContext.react","MWV2MediaViewerNullState.react","cr:5709","cr:5931","cr:5970","emptyFunction","justknobx","react","react-compiler-runtime","useMAWQuerySecureMediaAttachments","useMWMaybeInboxMediaRestoreLoop","useMWMediaLoadingQplLogger","useMWV2MediaViewerSecurePlayableUrl_CausesSuspense","useMWV2MediaViewerSecurePreviewUrl_CausesSuspense"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h||(h=d("react"));h.useCallback;function a(a){return j}function j(){}var k=b("cr:5709")==null?a:b("cr:5709");function e(a){var e=d("react-compiler-runtime").c(34),f=a.children,g=a.initialAttachment;a=a.thread;var h;e[0]===Symbol["for"]("react.memo_cache_sentinel")?(h=c("justknobx")._("3233"),e[0]=h):h=e[0];h=h;var j=c("useMAWQuerySecureMediaAttachments")(a.threadKey,h),m=j[0],n=j[2],o=j[3];j=j[4];c("useMWMaybeInboxMediaRestoreLoop")(a);var p=j!=null?j:!0;e[1]!==a.threadType?(j={entrypoint:"media_viewer",threadType:a.threadType},e[1]=a.threadType,e[2]=j):j=e[2];j=c("useMWMediaLoadingQplLogger")(j);if(e[3]!==(n==null?void 0:n.lastLoadedMessageId)){var q;q=(q=d("MAWDbMsg").toMsgId((q=n==null?void 0:n.lastLoadedMessageId)!=null?q:""))!=null?q:void 0;e[3]=n==null?void 0:n.lastLoadedMessageId;e[4]=q}else q=e[4];e[5]!==p||e[6]!==o||e[7]!==j||e[8]!==q||e[9]!==a.threadKey?(h={earliestLoadedMediaMessageId:q,hasMoreBefore:p,mediaGalleryGroup:c("LSThreadMediaGalleryGroup").PHOTOS_AND_VIDEOS,minTimestampMs:o,pageSize:h,qplLogger:j,threadKey:a.threadKey},e[5]=p,e[6]=o,e[7]=j,e[8]=q,e[9]=a.threadKey,e[10]=h):h=e[10];var r=k(h);e[11]!==p||e[12]!==r?(o=function(){p&&r()},e[11]=p,e[12]=r,e[13]=o):o=e[13];q=o;e[14]!==n||e[15]!==p||e[16]!==q||e[17]!==m||e[18]!==j.logLoadMediaCancel||e[19]!==j.logLoadMediaSuccess?(a={attachmentsRange:n,hasMore:p,loadMore:q,logLoadMediaCancel:j.logLoadMediaCancel,logLoadMediaSuccess:j.logLoadMediaSuccess,media:m},e[14]=n,e[15]=p,e[16]=q,e[17]=m,e[18]=j.logLoadMediaCancel,e[19]=j.logLoadMediaSuccess,e[20]=a):a=e[20];h=d("MWSharedAttachmentsSectionHooks").useLoader(a);o=h[1];n=c("useMWV2MediaViewerSecurePreviewUrl_CausesSuspense")();q=c("useMWV2MediaViewerSecurePlayableUrl_CausesSuspense")();j=l;if(b("cr:5970")==null||b("cr:5931")==null){e[21]===Symbol["for"]("react.memo_cache_sentinel")?(a=i.jsx(c("MWV2MediaViewerNullState.react"),{}),e[21]=a):a=e[21];return a}e[22]!==f||e[23]!==q||e[24]!==n||e[25]!==g||e[26]!==m?(h=i.jsx(d("MWChatAttachmentMediaState.react").MWChatAttachmentMediaStateProviderFromAttachments,{attachments:m,getIsSecureThread:j,getPlayableUrl:q,getPreviewUrl:n,initialAttachment:g,children:f}),e[22]=f,e[23]=q,e[24]=n,e[25]=g,e[26]=m,e[27]=h):h=e[27];e[28]!==q||e[29]!==n||e[30]!==o||e[31]!==m||e[32]!==h?(a=i.jsx(d("MWV2MediaViewerContext.react").MWV2MediaViewerContextProvider,{getDownloadUrl:q,getPlayableUrl:q,getPreviewUrl:n,heroLoggingComponent:c("emptyFunction"),loadMore:o,media:m,children:h}),e[28]=q,e[29]=n,e[30]=o,e[31]=m,e[32]=h,e[33]=a):a=e[33];return a}function l(){return!0}g["default"]=e}),98);
__d("MWV2MediaViewer.react",["FBLogger","FocusRegion.react","FocusWithinHandler.react","I64","LSMessagingThreadTypeUtil","MAWThreadCutover","MWFocusTable.react","MWLSThread","MWPThreadCapabilitiesContext","MWV2MediaViewerCutoverWrapper.react","MWV2MediaViewerNullState.react","MWV2MediaViewerOpenWrapper.react","MWV2MediaViewerSecureWrapper.react","XPlatReactFocusRegion.react","cr:7186","focusScopeQueries","justknobx","react","react-compiler-runtime","useMWMediaViewerOpenQPLLogger"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j=h||(h=d("react"));e=h;e.useCallback;var k=e.useEffect,l=e.useId;function a(a){var e=d("react-compiler-runtime").c(54),f=a.attachment,g=a.onClose;a=d("useMWMediaViewerOpenQPLLogger").useMWMediaViewerOpenQPLLogger();var h=a.endSuccess,m;e[0]!==h?(a=function(){h()},m=[h],e[0]=h,e[1]=a,e[2]=m):(a=e[1],m=e[2]);k(a,m);a=d("MWLSThread").useThread(f.threadKey);m=d("MWPThreadCapabilitiesContext").Provider;var n=l(),o;e[3]!==n?(o=function(a){a||d("FocusRegion.react").focusRegionById(n,d("MWFocusTable.react").tabbableScopeQuery)},e[3]=n,e[4]=o):o=e[4];o=o;var p=d("MAWThreadCutover").useGetCutoverOpenThreadKey(f.threadKey),q=d("MAWThreadCutover").useCutoverSecureThreadKeyForOpenThreadKey(p==null?f.threadKey:void 0);if(a==null){c("FBLogger")("messenger_web_media").mustfix("Thread is null in media viewer for attachment with threadKey: %s",(i||(i=d("I64"))).to_string(f.threadKey));var r;e[5]===Symbol["for"]("react.memo_cache_sentinel")?(r=j.jsx(c("MWV2MediaViewerNullState.react"),{}),e[5]=r):r=e[5];return r}r=d("LSMessagingThreadTypeUtil").isArmadilloSecure(a.threadType);if(p!=null||q!=null){p=p!=null?p:a.threadKey;q=q!=null?q:a.threadKey;var s;e[6]!==g?(s=function(){g&&g()},e[6]=g,e[7]=s):s=e[7];var t;e[8]!==f||e[9]!==s||e[10]!==a?(t=j.jsx(b("cr:7186"),{initialAttachment:f,onClose:s,thread:a}),e[8]=f,e[9]=s,e[10]=a,e[11]=t):t=e[11];e[12]!==f||e[13]!==p||e[14]!==q||e[15]!==t||e[16]!==a.threadType?(s=j.jsx(c("MWV2MediaViewerCutoverWrapper.react"),{initialAttachment:f,openThreadKey:p,secureThreadKey:q,threadType:a.threadType,children:t}),e[12]=f,e[13]=p,e[14]=q,e[15]=t,e[16]=a.threadType,e[17]=s):s=e[17];p=s;e[18]!==p||e[19]!==a?(q=j.jsx(m,{thread:a,children:p}),e[18]=p,e[19]=a,e[20]=q):q=e[20];t=q;e[21]!==t||e[22]!==n?(s=j.jsx(c("XPlatReactFocusRegion.react"),{autoFocusQuery:d("MWFocusTable.react").tabbableScopeQuery,containFocusQuery:d("MWFocusTable.react").tabbableScopeQuery,id:n,recoverFocusQuery:d("focusScopeQueries").headerFirstTabbableSecondScopeQuery,children:t}),e[21]=t,e[22]=n,e[23]=s):s=e[23];p=s;e[24]!==p||e[25]!==o?(q=c("justknobx")._("3588")?j.jsx(c("FocusWithinHandler.react"),{onFocusChange:o,onFocusVisibleChange:o,children:p}):p,e[24]=p,e[25]=o,e[26]=q):q=e[26];return q}if(r){e[27]!==g?(t=function(){g&&g()},e[27]=g,e[28]=t):t=e[28];e[29]!==f||e[30]!==t||e[31]!==a?(s=j.jsx(b("cr:7186"),{initialAttachment:f,onClose:t,thread:a}),e[29]=f,e[30]=t,e[31]=a,e[32]=s):s=e[32];e[33]!==f||e[34]!==s||e[35]!==a?(p=j.jsx(c("MWV2MediaViewerSecureWrapper.react"),{initialAttachment:f,thread:a,children:s}),e[33]=f,e[34]=s,e[35]=a,e[36]=p):p=e[36];q=p;e[37]!==q||e[38]!==a?(r=j.jsx(m,{thread:a,children:q}),e[37]=q,e[38]=a,e[39]=r):r=e[39];t=r;e[40]!==t||e[41]!==n?(s=j.jsx(c("XPlatReactFocusRegion.react"),{autoFocusQuery:d("MWFocusTable.react").tabbableScopeQuery,containFocusQuery:d("MWFocusTable.react").tabbableScopeQuery,id:n,recoverFocusQuery:d("focusScopeQueries").headerFirstTabbableSecondScopeQuery,children:t}),e[40]=t,e[41]=n,e[42]=s):s=e[42];p=s;e[43]!==p||e[44]!==o?(m=c("justknobx")._("3588")?j.jsx(c("FocusWithinHandler.react"),{onFocusChange:o,onFocusVisibleChange:o,children:p}):p,e[43]=p,e[44]=o,e[45]=m):m=e[45];return m}e[46]!==f||e[47]!==g||e[48]!==a?(q=j.jsx(b("cr:7186"),{initialAttachment:f,onClose:g,thread:a}),e[46]=f,e[47]=g,e[48]=a,e[49]=q):q=e[49];e[50]!==f||e[51]!==q||e[52]!==a?(r=j.jsx(c("MWV2MediaViewerOpenWrapper.react"),{initialAttachment:f,thread:a,children:q}),e[50]=f,e[51]=q,e[52]=a,e[53]=r):r=e[53];return r}g["default"]=a}),98);
__d("MWV2MediaViewerAspectRatioContainer.react",["BaseAspectRatioContainer.react","gkx","react","react-compiler-runtime","stylex"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j=i||d("react"),k={marginTop:"xr1yuqi",marginInlineEnd:"x11t971q",marginBottom:"x4ii5y1",marginInlineStart:"xvc5jky",maxHeight:"x1jols5v",maxWidth:"xf68679",width:"xh8yej3",$$css:!0},l={transform:"xsqj5wx",$$css:!0},m={containerMaxSize:function(a,b,c){return[k,{aspectRatio:b!=null?"x10y9f9r":b,$$css:!0},{"--x-aspectRatio":b!=null?b:void 0,"--x-maxHeight":function(a){return typeof a==="number"?a+"px":a!=null?a:void 0}("min(calc(100vh - "+c+"px),"+(a!=null?a:1e4)+"px)"),"--x-maxWidth":function(a){return typeof a==="number"?a+"px":a!=null?a:void 0}("min(calc((100vh - "+c+"px) * "+b+"),"+(a!=null?a:1e4)*b+"px)")}]},scale:function(a){return[l,{"--x-transform":"scale3d("+a+", "+a+", 1)"!=null?"scale3d("+a+", "+a+", 1)":void 0}]}};function a(a){var b=d("react-compiler-runtime").c(20),e=a.children,f=a.height,g=a.imageContainerRef,i=a.imageExpansionFactor,k=a.isImageExpanded,l=a.onClickOutsideOfChildren,o=a.outsideContainerRef;a=a.width;i=i===void 0?1:i;k=k===void 0?!1:k;a=a!=null&&f!=null?a/f:1;var p=c("gkx")("17009")?174:76,q;b[0]===Symbol["for"]("react.memo_cache_sentinel")?(q={className:"x6s0dn4 x78zum5 x5yr21d xl56j7k xh8yej3"},b[0]=q):q=b[0];if(b[1]!==a||b[2]!==f||b[3]!==i||b[4]!==k){var r;b[6]!==i||b[7]!==k?(r=k&&m.scale(i),b[6]=i,b[7]=k,b[8]=r):r=b[8];p=(h||(h=c("stylex"))).props(m.containerMaxSize(f,a,p),r);b[1]=a;b[2]=f;b[3]=i;b[4]=k;b[5]=p}else p=b[5];b[9]!==a||b[10]!==e?(r=j.jsx(c("BaseAspectRatioContainer.react"),{aspectRatio:a,children:e}),b[9]=a,b[10]=e,b[11]=r):r=b[11];b[12]!==g||b[13]!==p||b[14]!==r?(f=j.jsx("div",babelHelpers["extends"]({},p,{"aria-hidden":!0,onClick:n,ref:g,children:r})),b[12]=g,b[13]=p,b[14]=r,b[15]=f):f=b[15];b[16]!==l||b[17]!==o||b[18]!==f?(i=j.jsx("div",babelHelpers["extends"]({"aria-hidden":!0},q,{onClick:l,ref:o,children:f})),b[16]=l,b[17]=o,b[18]=f,b[19]=i):i=b[19];return i}function n(a){a.cancelBubble=!0,a.stopPropagation()}g["default"]=a}),98);
__d("MWV2MediaViewerDownloadControl.react",["fbt","MWV2MediaViewerActionButton.react","MWXIconDownload","MWXRowItem.react","MessengerWebUXLogger","react","react-compiler-runtime"],(function(a,b,c,d,e,f,g,h){"use strict";var i,j=i||d("react"),k=h._(/*BTDS*/"Download");function a(a){var b=d("react-compiler-runtime").c(7);a=a.uri;var e=c("MessengerWebUXLogger").useInteractionLogger(),f;b[0]!==a?(f={download:!0,target:"_blank",url:a},b[0]=a,b[1]=f):f=b[1];b[2]!==e?(a=function(){e==null||e({eventName:"fsmv_download_click"})},b[2]=e,b[3]=a):a=b[3];var g;b[4]!==f||b[5]!==a?(g=j.jsx(c("MWXRowItem.react"),{children:j.jsx(c("MWV2MediaViewerActionButton.react"),{icon:c("MWXIconDownload"),label:k,linkProps:f,onPress:a})}),b[4]=f,b[5]=a,b[6]=g):g=b[6];return g}g["default"]=a}),226);
__d("MWV2MediaViewerForwardControl.react",["fbt","Int64Hooks","LSMessagingThreadTypeUtil","MWV2MediaViewerActionButton.react","MWXIconShare","MWXRowItem.react","ODS","react","react-compiler-runtime","useMWHasForwardAction","useMWV2MessageForwardAction"],(function(a,b,c,d,e,f,g,h){"use strict";var i,j,k=i||d("react");function a(a){var b=d("react-compiler-runtime").c(8),e=a.attachment,f=a.message,g=a.thread;a=e==null?void 0:e.attachmentFbid;var i;b[0]!==g.threadType?(i=d("LSMessagingThreadTypeUtil").isArmadilloSecure(g.threadType),b[0]=g.threadType,b[1]=i):i=b[1];i=i;var l,m;b[2]!==g.threadType?(l=function(){return g.threadType},m=[g.threadType],b[2]=g.threadType,b[3]=l,b[4]=m):(l=b[3],m=b[4]);l=d("Int64Hooks").useMemoInt64(l,m);var n=c("useMWV2MessageForwardAction")(i,f,l);m=c("useMWHasForwardAction")(g.threadType,f,e);i=m.hasForwardAction;l=a!=null&&i;if(a==null||!l)return null;b[5]===Symbol["for"]("react.memo_cache_sentinel")?(f=h._(/*BTDS*/"Forward"),b[5]=f):f=b[5];e=f;b[6]!==n?(m=k.jsx(c("MWXRowItem.react"),{children:k.jsx(c("MWV2MediaViewerActionButton.react"),{icon:c("MWXIconShare"),label:e,onPress:function(){(j||(j=d("ODS"))).bumpEntityKey(3185,"mwchat_media_viewer","forward"),n()},testid:void 0})}),b[6]=n,b[7]=m):m=b[7];return m}g["default"]=a}),226);
__d("MWV2MediaViewerControls.react",["MWV2MediaViewerCloseControl.react","MWV2MediaViewerContext.react","MWV2MediaViewerDownloadControl.react","MWV2MediaViewerForwardControl.react","MWXRow.react","cr:9742","react","react-compiler-runtime"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h||(h=d("react")),j=h.useContext;function a(a){var e=d("react-compiler-runtime").c(19),f=a.attachment,g=a.message,h=a.onClose;a=a.thread;var k=j(d("MWV2MediaViewerContext.react").context),l;e[0]!==f||e[1]!==k?(l=k.getDownloadUrl(f,"MWV2MediaViewerControls"),e[0]=f,e[1]=k,e[2]=l):l=e[2];k=l;e[3]!==f||e[4]!==g?(l=g!=null&&f!=null&&b("cr:9742")!=null&&i.jsx(b("cr:9742"),{attachment:f,message:g}),e[3]=f,e[4]=g,e[5]=l):l=e[5];var m;e[6]!==k?(m=k!=null&&i.jsx(c("MWV2MediaViewerDownloadControl.react"),{uri:k}),e[6]=k,e[7]=m):m=e[7];e[8]!==f||e[9]!==g||e[10]!==a?(k=g!=null?i.jsx(c("MWV2MediaViewerForwardControl.react"),{attachment:f,message:g,thread:a}):null,e[8]=f,e[9]=g,e[10]=a,e[11]=k):k=e[11];e[12]!==h?(f=h!=null?i.jsx(c("MWV2MediaViewerCloseControl.react"),{onClose:h}):null,e[12]=h,e[13]=f):f=e[13];e[14]!==l||e[15]!==m||e[16]!==k||e[17]!==f?(g=i.jsxs(c("MWXRow.react"),{paddingTop:0,spacing:8,testid:void 0,children:[l,m,k,f]}),e[14]=l,e[15]=m,e[16]=k,e[17]=f,e[18]=g):g=e[18];return g}g["default"]=a}),98);
__d("MWV2MediaViewerControlsContainer.react",["CometPlaceholder.react","MWV2MediaViewerControls.react","MWV2MediaViewerControlsFallback.react","cr:7197","react","react-compiler-runtime"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h||d("react");function a(a){var e=d("react-compiler-runtime").c(10),f=a.attachment,g=a.message,h=a.onClose;a=a.thread;var j;e[0]!==h?(j=h!=null&&!b("cr:7197")?i.jsx(c("MWV2MediaViewerControlsFallback.react"),{onClose:h}):null,e[0]=h,e[1]=j):j=e[1];var k;e[2]!==f||e[3]!==g||e[4]!==h||e[5]!==a?(k=b("cr:7197")?i.jsx(b("cr:7197"),{attachment:f,message:g,onClose:h,thread:a}):i.jsx(c("MWV2MediaViewerControls.react"),{attachment:f,message:g,onClose:h,thread:a}),e[2]=f,e[3]=g,e[4]=h,e[5]=a,e[6]=k):k=e[6];e[7]!==j||e[8]!==k?(f=i.jsx(c("CometPlaceholder.react"),{fallback:j,name:"MWV2MediaViewerContent.Controls",children:k}),e[7]=j,e[8]=k,e[9]=f):f=e[9];return f}g["default"]=a}),98);
__d("MWV2MediaViewerDimensions",["I64"],(function(a,b,c,d,e,f,g){"use strict";var h;b=1.75;function i(a){return a.previewHeightLarge!=null?(h||(h=d("I64"))).to_float(a.previewHeightLarge):a.previewHeight!=null?(h||(h=d("I64"))).to_float(a.previewHeight):void 0}function j(a){return a.previewWidthLarge!=null?(h||(h=d("I64"))).to_float(a.previewWidthLarge):a.previewWidth!=null?(h||(h=d("I64"))).to_float(a.previewWidth):void 0}function a(a){return{height:i(a),width:j(a)}}g.IMAGE_EXPANSION_FACTOR=b;g.getLargestAttachmentDimensions=a}),98);
__d("MWV2MediaViewerItemImage.react",["fbt","BaseImage.react","I64","MWAnimatedImageControlsUtil","MWAnimatedImageThumbnailWithPlayButton.react","MWChatAttachmentMediaState.react","MWV2MediaViewerContext.react","MWV2MediaViewerDimensions","MWXIconHd","MWXIconStrict.react","MWXPressable.react","MWXThreadThemeColor","MessagingAttachmentType","cr:7201","cr:7203","react","react-compiler-runtime"],(function(a,b,c,d,e,f,g,h){"use strict";var i,j,k=i||(i=d("react"));e=i;var l=e.useContext,m=e.useEffect,n=e.useRef,o=e.useState;function a(a){var e=d("react-compiler-runtime").c(31),f=a.attachment,g=a.imageContainerRef,i=a.mediaRenderQpl;a=a.outsideContainerRef;var q=d("MWAnimatedImageControlsUtil").useGetMessengerAutoplaySetting(),r=l(d("MWChatAttachmentMediaState.react").context);r=r.isImageExpanded;var s=l(d("MWV2MediaViewerContext.react").context),t=s.getPlayableUrl;s=s.heroLoggingComponent;var u=n(null),v=o(!1),w=v[0],x=v[1],y;e[0]!==i?(v=function(){var a;u.current!=null&&(a=u.current)!=null&&a.complete&&i.endSuccess()},y=[i],e[0]=i,e[1]=v,e[2]=y):(v=e[1],y=e[2]);m(v,y);e[3]!==f?(v=d("MWV2MediaViewerDimensions").getLargestAttachmentDimensions(f),e[3]=f,e[4]=v):v=e[4];y=v;v=y.height;y=y.width;var z=(j||(j=d("I64"))).to_int32(f.attachmentType)===c("MessagingAttachmentType").ANIMATED_IMAGE,A;e[5]!==f||e[6]!==t||e[7]!==i?(A=t(f,"MediaViewerImage",i),e[5]=f,e[6]=t,e[7]=i,e[8]=A):A=e[8];t=A;if(t!=null){var B=z&&q!==d("MWAnimatedImageControlsUtil").MWAutoplayAnimationsSetting.ON;e[9]!==s?(A=s("MWV2MediaViewerImage"),e[9]=s,e[10]=A):A=e[10];e[11]!==f||e[12]!==v||e[13]!==g||e[14]!==z||e[15]!==w||e[16]!==i||e[17]!==a||e[18]!==B||e[19]!==t||e[20]!==y?(q=B?w===!1?k.jsx(d("MWAnimatedImageThumbnailWithPlayButton.react").MWAnimatedImageThumbnailWithPlayButton,{connectBottom:!1,connectTop:!1,dbAttachment:f,entryPoint:d("MWAnimatedImageThumbnailWithPlayButton.react").AnimatedImageEntryPoint.MediaViewer,mediaRenderQpl:i,message:null,onPlay:function(){return x(!0)},outgoing:!1,previewHeight:v,previewWidth:y}):k.jsx(c("MWXPressable.react"),{"aria-label":h._(/*BTDS*/"Pause GIF"),hideHoverOverlay:!0,onPress:function(){B&&x(!1)},children:k.jsx(c("BaseImage.react"),{height:"100%",objectFit:"contain",onError:function(){i.endFail("load-image-error")},onLoad:function(){i.endSuccess()},ref:u,src:t,width:"100%"})}):!z&&b("cr:7203")!=null?k.jsx(b("cr:7203"),{imageContainerRef:g,outsideContainerRef:a,children:k.jsx(c("BaseImage.react"),{height:"100%",objectFit:"contain",onError:function(){i.endFail("load-image-error")},onLoad:function(){i.endSuccess()},ref:u,src:t,width:"100%"})}):k.jsx(c("BaseImage.react"),{height:"100%",objectFit:"contain",onError:function(){i.endFail("load-image-error")},onLoad:function(){i.endSuccess()},ref:u,src:t,width:"100%"}),e[11]=f,e[12]=v,e[13]=g,e[14]=z,e[15]=w,e[16]=i,e[17]=a,e[18]=B,e[19]=t,e[20]=y,e[21]=q):q=e[21];e[22]!==f||e[23]!==r?(s=k.jsx(p,{attachment:f,shouldHide:r}),v=b("cr:7201")&&k.jsx(b("cr:7201"),{attachment:f,shouldHide:r}),e[22]=f,e[23]=r,e[24]=s,e[25]=v):(s=e[24],v=e[25]);e[26]!==A||e[27]!==q||e[28]!==s||e[29]!==v?(g=k.jsxs(k.Fragment,{children:[A,q,s,v]}),e[26]=A,e[27]=q,e[28]=s,e[29]=v,e[30]=g):g=e[30];return g}else{i.endFail("missing-playable-url");return null}}function p(a){var b=d("react-compiler-runtime").c(6),e=a.attachment;a=a.shouldHide;a=a===void 0?!1:a;e=e;e=e.isHd===!0;if(!e)return null;b[0]!==a?(e={0:{className:"x78zum5 x5yr21d x47corl x10l6tqk xh8yej3"},1:{className:"x5yr21d x47corl x10l6tqk xh8yej3 x1s85apg"}}[!!a<<0],b[0]=a,b[1]=e):e=b[1];b[2]===Symbol["for"]("react.memo_cache_sentinel")?(a={className:"xdg88n9 x10l6tqk xomnu4r"},b[2]=a):a=b[2];b[3]===Symbol["for"]("react.memo_cache_sentinel")?(a=k.jsx("div",babelHelpers["extends"]({},a,{children:k.jsx(c("MWXIconStrict.react"),{color:d("MWXThreadThemeColor").mwxThreadThemeColor("rgba(255,255,255,0.7)"),icon:c("MWXIconHd"),size:24})})),b[3]=a):a=b[3];b[4]!==e?(a=k.jsx("div",babelHelpers["extends"]({},e,{children:a})),b[4]=e,b[5]=a):a=b[5];return a}g["default"]=a}),226);
__d("MWV2MediaViewerItemVideo.react",["MWChatVideoPlayer.react","MWV2MediaViewerContext.react","cr:7201","react","react-compiler-runtime"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h||(h=d("react")),j=h.useContext;function a(a){var e=d("react-compiler-runtime").c(14),f=a.attachment;a=a.mediaRenderQpl;var g=j(d("MWV2MediaViewerContext.react").context);g=g.getPlayableUrl;var h;e[0]!==f||e[1]!==g||e[2]!==a?(h=g(f,"MediaViewerVideo",a),e[0]=f,e[1]=g,e[2]=a,e[3]=h):h=e[3];g=h;if(g!=null){e[4]===Symbol["for"]("react.memo_cache_sentinel")?(h={className:"x78zum5 x1iyjqo2 xmz0i5r"},e[4]=h):h=e[4];var k;e[5]!==f.attachmentFbid||e[6]!==a||e[7]!==g?(k=i.jsx(c("MWChatVideoPlayer.react"),{controls:"mwchat",fbid:f.attachmentFbid,hideExpandButton:!1,isMediaViewer:!0,mediaRenderQpl:a,originalHeight:1e3,originalWidth:1e3,sdSrc:g,shouldForcePauseOnClick:!1}),e[5]=f.attachmentFbid,e[6]=a,e[7]=g,e[8]=k):k=e[8];e[9]!==f?(g=b("cr:7201")&&i.jsx(b("cr:7201"),{attachment:f}),e[9]=f,e[10]=g):g=e[10];e[11]!==k||e[12]!==g?(f=i.jsxs("div",babelHelpers["extends"]({},h,{children:[k,g]})),e[11]=k,e[12]=g,e[13]=f):f=e[13];return f}else{a.endFail("missing-playable-url");return null}}g["default"]=a}),98);
__d("MWV2MediaViewerItem.react",["I64","LSIntEnum","MWChatAttachmentMediaState.react","MWMediaViewerRenderQpl","MWV2MediaViewerAspectRatioContainer.react","MWV2MediaViewerDimensions","MWV2MediaViewerItemImage.react","MWV2MediaViewerItemVideo.react","MWV2MediaViewerNullState.react","MessagingAttachmentType","react","react-compiler-runtime"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j,k=h||(h=d("react"));b=h;var l=b.useContext,m=b.useRef;function a(a){var b=d("react-compiler-runtime").c(10),e=a.attachment,f=a.onClose;a=a.threadType;var g=e.attachmentType;if(!((i||(i=d("I64"))).equal(g,(j||(j=d("LSIntEnum"))).ofNumber(c("MessagingAttachmentType").IMAGE))||(i||(i=d("I64"))).equal(g,(j||(j=d("LSIntEnum"))).ofNumber(c("MessagingAttachmentType").ANIMATED_IMAGE))||(i||(i=d("I64"))).equal(g,(j||(j=d("LSIntEnum"))).ofNumber(c("MessagingAttachmentType").VIDEO)))){b[0]===Symbol["for"]("react.memo_cache_sentinel")?(g=k.jsx(c("MWV2MediaViewerNullState.react"),{}),b[0]=g):g=b[0];return g}b[1]===Symbol["for"]("react.memo_cache_sentinel")?(g={className:"x1ey2m1c xtijo5x x1o0tod x10l6tqk x13vifvy"},b[1]=g):g=b[1];b[2]!==f?(g=k.jsx("div",babelHelpers["extends"]({"aria-hidden":!0},g,{"data-testid":void 0,onClick:f})),b[2]=f,b[3]=g):g=b[3];b[4]!==e||b[5]!==a?(f=k.jsx(n,{attachment:e,threadType:a}),b[4]=e,b[5]=a,b[6]=f):f=b[6];b[7]!==g||b[8]!==f?(e=k.jsxs(k.Fragment,{children:[g,f]}),b[7]=g,b[8]=f,b[9]=e):e=b[9];return e}function n(a){var b=d("react-compiler-runtime").c(11),e=a.attachment,f=a.onClose;a=a.threadType;a=d("MWMediaViewerRenderQpl").useMediaViewerRenderQpl(e,a);var g=l(d("MWChatAttachmentMediaState.react").context);g=g.isImageExpanded;var h=g?d("MWV2MediaViewerDimensions").IMAGE_EXPANSION_FACTOR:1,n=m(null),o=m(null),p;b[0]!==e?(p=d("MWV2MediaViewerDimensions").getLargestAttachmentDimensions(e),b[0]=e,b[1]=p):p=b[1];p=p;var q=p.height;p=p.width;var r=e.attachmentType;b[2]!==e||b[3]!==q||b[4]!==h||b[5]!==g||b[6]!==a||b[7]!==f||b[8]!==r||b[9]!==p?(o=(i||(i=d("I64"))).equal(r,(j||(j=d("LSIntEnum"))).ofNumber(c("MessagingAttachmentType").IMAGE))||(i||(i=d("I64"))).equal(r,(j||(j=d("LSIntEnum"))).ofNumber(c("MessagingAttachmentType").ANIMATED_IMAGE))?k.jsx(c("MWV2MediaViewerAspectRatioContainer.react"),{height:q,imageContainerRef:o,imageExpansionFactor:h,isImageExpanded:g,onClickOutsideOfChildren:f,outsideContainerRef:n,width:p,children:k.jsx(c("MWV2MediaViewerItemImage.react"),{attachment:e,imageContainerRef:o,mediaRenderQpl:a,outsideContainerRef:n})}):(i||(i=d("I64"))).equal(r,(j||(j=d("LSIntEnum"))).ofNumber(c("MessagingAttachmentType").VIDEO))?k.jsx(c("MWV2MediaViewerItemVideo.react"),{attachment:e,mediaRenderQpl:a}):null,b[2]=e,b[3]=q,b[4]=h,b[5]=g,b[6]=a,b[7]=f,b[8]=r,b[9]=p,b[10]=o):o=b[10];return o}g["default"]=a}),98);
__d("MWV2MediaViewerContent.react",["fbt","CometHideLayerOnEscape.react","CometPlaceholder.react","FDSBlurredBackgroundImage.react","I64","LSIntEnum","MWChatAttachmentMediaNavigationHotkeys.react","MWChatAttachmentMediaState.react","MWChatAttachmentMediaThumbnails.react","MWChatMediaViewerNavigationTapTarget.react","MWV2MediaViewerContainer.react","MWV2MediaViewerContext.react","MWV2MediaViewerControlsContainer.react","MWV2MediaViewerItem.react","MWV2MediaViewerNullState.react","MWXColumn.react","MWXColumnItem.react","MWXRow.react","MWXRowItem.react","MessagingAttachmentType","ReQL","ReQLSuspense","justknobx","react","react-compiler-runtime","useReStore","useShouldShowPlaybackErrorFallback","useShouldShowUnsupportedCodecFallback"],(function(a,b,c,d,e,f,g,h){"use strict";var i,j,k,l,m=j||(j=d("react"));b=j;var n=b.useContext,o=b.useEffect,p={mediaItem:{marginTop:"x14vqqas",marginInlineEnd:"xbmvrgn",marginBottom:"xod5an3",marginInlineStart:"x1diwwjn",$$css:!0},mediaRow:{minHeight:"x2lwn1j",$$css:!0},noOverflow:{maxWidth:"x193iq5w",overflowX:"x6ikm8r",overflowY:"x10wlt62",$$css:!0}};function q(a){var b=d("react-compiler-runtime").c(6);a=a.attachment;var e=n(d("MWV2MediaViewerContext.react").context);e=e.getPreviewUrl;if(a==null||(k||(k=d("I64"))).equal(a.attachmentType,(l||(l=d("LSIntEnum"))).ofNumber(c("MessagingAttachmentType").ANIMATED_IMAGE)))return null;var f;b[0]!==a||b[1]!==e?(f=e(a,"BlurredBackground"),b[0]=a,b[1]=e,b[2]=f):f=b[2];a=f;if(a==null)return null;b[3]===Symbol["for"]("react.memo_cache_sentinel")?(e={className:"x1ey2m1c xtijo5x x1o0tod xuzhngd x10l6tqk x13vifvy"},b[3]=e):e=b[3];b[4]!==a?(f=m.jsx("div",babelHelpers["extends"]({},e,{children:m.jsx(c("FDSBlurredBackgroundImage.react"),{src:a})})),b[4]=a,b[5]=f):f=b[5];return f}function a(a){var b=d("react-compiler-runtime").c(69),e=a.initialAttachment,g=a.onClose;a=a.thread;var j=n(d("MWChatAttachmentMediaState.react").context),k=j.canMoveBackward,l=j.canMoveForward,r=j.card,s=j.isImageExpanded,t=j.moveBackward,u=j.moveForward;j=j.shouldTriggerLoadMore;var v=n(d("MWV2MediaViewerContext.react").context),w=v.getPreviewUrl,x=v.loadMore,y=(i||(i=c("useReStore")))(),z=e==null?void 0:e.threadKey,A=e==null?void 0:e.messageId;b[0]!==y.tables.attachments||b[1]!==A||b[2]!==z?(v=function(){return d("ReQL").fromTableDescending(y.tables.attachments).getKeyRange(z,A)},b[0]=y.tables.attachments,b[1]=A,b[2]=z,b[3]=v):v=b[3];var B;b[4]!==y||b[5]!==A||b[6]!==z?(B=[y,A,z],b[4]=y,b[5]=A,b[6]=z,b[7]=B):B=b[7];v=d("ReQLSuspense").useFirst(v,B,f.id+":114")!=null;var C=r!=null?r.attachment:v?e:void 0;b[8]!==C||b[9]!==y.tables.messages?(B=function(){return(C==null?void 0:C.messageId)==null?d("ReQL").empty():d("ReQL").fromTableAscending(y.tables.messages.index("messageId")).getKeyRange(C.messageId)},b[8]=C,b[9]=y.tables.messages,b[10]=B):B=b[10];r=C==null?void 0:C.messageId;b[11]!==y.tables.messages||b[12]!==r?(v=[r,y.tables.messages],b[11]=y.tables.messages,b[12]=r,b[13]=v):v=b[13];e=d("ReQLSuspense").useFirst(B,v,f.id+":130");var D=j;b[14]!==x||b[15]!==D?(r=function(){D&&x()},B=[D,x],b[14]=x,b[15]=D,b[16]=r,b[17]=B):(r=b[16],B=b[17]);o(r,B);v=c("useShouldShowUnsupportedCodecFallback")(C);j=c("useShouldShowPlaybackErrorFallback")(C);b[18]!==C||b[19]!==j||b[20]!==v||b[21]!==g||b[22]!==a?(r=C==null?m.jsx(c("MWV2MediaViewerNullState.react"),{}):!v&&!j?m.jsx(c("MWV2MediaViewerItem.react"),{attachment:C,onClose:g,threadType:a.threadType}):null,b[18]=C,b[19]=j,b[20]=v,b[21]=g,b[22]=a,b[23]=r):r=b[23];B=r;b[24]===Symbol["for"]("react.memo_cache_sentinel")?(j=c("justknobx")._("3491"),b[24]=j):j=b[24];v=j;b[25]!==C||b[26]!==e||b[27]!==g||b[28]!==a?(r=m.jsx(c("MWV2MediaViewerControlsContainer.react"),{attachment:C,message:e,onClose:g,thread:a}),b[25]=C,b[26]=e,b[27]=g,b[28]=a,b[29]=r):r=b[29];b[30]!==g?(j=v?null:m.jsx(d("MWChatAttachmentMediaNavigationHotkeys.react").MWChatAttachmentMediaNavigationHotkeys,{onClose:g}),b[30]=g,b[31]=j):j=b[31];b[32]!==C?(e=m.jsx(c("CometPlaceholder.react"),{fallback:null,name:"MWV2MediaViewerContent.BlurredBackground",children:m.jsx(q,{attachment:C})}),b[32]=C,b[33]=e):e=b[33];b[34]===Symbol["for"]("react.memo_cache_sentinel")?(a=[p.mediaRow,p.noOverflow],b[34]=a):a=b[34];var E;b[35]===Symbol["for"]("react.memo_cache_sentinel")?(E=h._(/*BTDS*/"Previous photo"),b[35]=E):E=b[35];k=!k;b[36]!==s||b[37]!==t||b[38]!==k?(E=m.jsx(c("MWXRowItem.react"),{children:m.jsx(c("MWChatMediaViewerNavigationTapTarget.react"),{direction:"previous",label:E,onClick:t,shouldHide:k,shouldHideWithoutTransition:s,testid:void 0})}),b[36]=s,b[37]=t,b[38]=k,b[39]=E):E=b[39];b[40]!==B?(t=m.jsx(c("MWXRowItem.react"),{expanding:!0,verticalAlign:"stretch",xstyle:p.mediaItem,children:m.jsx(c("CometPlaceholder.react"),{fallback:null,name:"MWV2MediaViewerContent.MediaContent",children:B})}),b[40]=B,b[41]=t):t=b[41];b[42]===Symbol["for"]("react.memo_cache_sentinel")?(k=h._(/*BTDS*/"Next photo"),b[42]=k):k=b[42];B=!l;b[43]!==s||b[44]!==u||b[45]!==B?(l=m.jsx(c("MWXRowItem.react"),{children:m.jsx(c("MWChatMediaViewerNavigationTapTarget.react"),{direction:"next",label:k,onClick:u,shouldHide:B,shouldHideWithoutTransition:s,testid:void 0})}),b[43]=s,b[44]=u,b[45]=B,b[46]=l):l=b[46];b[47]!==E||b[48]!==t||b[49]!==l?(k=m.jsx(c("MWXColumnItem.react"),{expanding:!0,verticalAlign:"center",children:m.jsxs(c("MWXRow.react"),{align:"justify",expanding:!0,paddingHorizontal:0,paddingVertical:0,spacingHorizontal:0,verticalAlign:"stretch",xstyle:a,children:[E,t,l]})}),b[47]=E,b[48]=t,b[49]=l,b[50]=k):k=b[50];b[51]!==w||b[52]!==s?(u=m.jsx(c("MWXColumnItem.react"),{children:m.jsx(c("MWChatAttachmentMediaThumbnails.react"),{getPreviewUrl:w,shouldHide:s})}),b[51]=w,b[52]=s,b[53]=u):u=b[53];b[54]!==k||b[55]!==u?(B=m.jsxs(c("MWXColumn.react"),{align:"stretch",expanding:!0,paddingHorizontal:0,verticalAlign:"space-between",children:[k,u]}),b[54]=k,b[55]=u,b[56]=B):B=b[56];b[57]!==s||b[58]!==r||b[59]!==j||b[60]!==e||b[61]!==B?(a=m.jsxs(c("MWV2MediaViewerContainer.react"),{actions:r,hideActions:s,children:[j,e,B]}),b[57]=s,b[58]=r,b[59]=j,b[60]=e,b[61]=B,b[62]=a):a=b[62];E=a;if(g!=null)if(v){b[63]!==E||b[64]!==g?(t=m.jsx(d("MWChatAttachmentMediaNavigationHotkeys.react").MWChatAttachmentMediaNavigationHotkeys,{onClose:g,children:E}),b[63]=E,b[64]=g,b[65]=t):t=b[65];return t}else{b[66]!==E||b[67]!==g?(l=m.jsx(c("CometHideLayerOnEscape.react"),{onHide:g,children:E}),b[66]=E,b[67]=g,b[68]=l):l=b[68];return l}return E}g["default"]=a}),226);
__d("useMWInboxMediaRestoreLoop",["Int64Hooks","LSMessagingThreadTypeUtil","MAWMiActOnActThreadReadyDeferred","promiseDone","react","react-compiler-runtime","requireDeferred","useAsyncReStore"],(function(a,b,c,d,e,f,g){"use strict";var h;b=h||d("react");b.useCallback;var i=b.useState,j=c("requireDeferred")("MAWFTSRestoreSync").__setRef("useMWInboxMediaRestoreLoop");function a(a){var b=d("react-compiler-runtime").c(14),e=a.threadKey,f=c("useAsyncReStore")(),g=i(null),h=g[0],k=g[1],l;b[0]!==f||b[1]!==h||b[2]!==a.threadType||b[3]!==e?(g=function(){var b=async function(){var a=await f;c("promiseDone")(c("MAWMiActOnActThreadReadyDeferred")(a,e,"mediaRestore",function(a,b){j.onReady(function(a){a=a.getMediaRestoreSync;a().setActiveThreadId(b);c("promiseDone")(a().startMediaSyncingLoop());k(a())});return Promise.resolve()}))};d("LSMessagingThreadTypeUtil").isArmadilloSecure(a.threadType)&&c("promiseDone")(b());return function(){h==null||h.setIsStarted(!1),h==null||h.setShouldPauseRestore(!0)}},l=[f,h,a.threadType,e],b[0]=f,b[1]=h,b[2]=a.threadType,b[3]=e,b[4]=g,b[5]=l):(g=b[4],l=b[5]);d("Int64Hooks").useEffectInt64(g,l);b[6]!==h?(g=function(){h!=null&&(h.resetEBAvailability(),h.isStarted()||c("promiseDone")(h.startMediaSyncingLoop()))},b[6]=h,b[7]=g):g=b[7];var m=g;b[8]!==h?(l=function(){h!=null&&(h.isStarted()||c("promiseDone")(h.startMediaSyncingLoop()))},b[8]=h,b[9]=l):l=b[9];var n=l;b[10]!==m||b[11]!==n?(g=function(){return{onEBOnboarded:m,startMediaSync:n}},l=[m,n],b[10]=m,b[11]=n,b[12]=g,b[13]=l):(g=b[12],l=b[13]);return d("Int64Hooks").useMemoInt64(g,l)}g.default=a}),98);